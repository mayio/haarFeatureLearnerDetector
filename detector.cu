/*
 *
 *  Created on: May 17, 2017
 *      Author: Mario LÃ¼der
 *
 */

#include <stdio.h>
#include <stdlib.h>


#include "Learner.cuh"
#include "Classifier.cuh"
#include "FeatureTypes.cuh"
#include "FeatureValues.cuh"
#include "Image.cuh"

// load image includes
#include <opencv2/core/core.hpp>
#include <opencv2/highgui/highgui.hpp>

#include <cuda_profiler_api.h>

#include "utilities.cuh"
#include "defines.cuh"


void detectInImageAndDisplay(const std::string & strongClassifierStr)
{
   /* faces
   std::string strongClassifierStr = std::string() +
         "[[[[[[[49,22,1]],[[49,22,-1]]],18,0,0.0332471,-90686,1],[[[[12,36,1],[12,36,-1]]],0,12,0.0991827,-9593,1],[[[[16,6,1],[16,6,-1]]],57,84,0.148353,2177,-1]]," +
         "[0.0343905,0.110103,0.174196]," +
         "1.74758]," +
         "[[[[[[8,12,1]],[[8,12,-1]]],84,64,0.0523191,-7807,1],[[[[14,16,1]],[[14,16,-1]]],33,12,0.0340082,-27205,1],[[[[22,36,1],[22,36,-1]]],45,12,0.114434,21409,-1],[[[[14,22,1]],[[14,22,-1]]],12,0,0.189615,-7194,1],[[[[26,4,1]],[[26,4,-1]]],30,100,0.165921,1563,-1],[[[[6,12,1]],[[6,12,-1]]],81,88,0.183366,66521,1]]," +
         "[0.0552076,0.0352054,0.129221,0.233982,0.198927,0.224539]," +
         "5.84288]," +
         "[[[[[[12,26,1],[12,26,-1],[12,26,1]]],36,76,0.0178653,22526,-1],[[[[2,10,1],[2,10,-1]]],3,20,0.0707651,-591,1],[[[[12,26,1],[12,26,-1]]],0,72,0.173719,-2579,1],[[[[49,16,1]],[[49,16,-1]]],27,0,0.175738,-24893,1],[[[[10,4,1]],[[10,4,-1]]],72,80,0.21342,181,-1],[[[[29,49,1],[29,49,-1]]],30,56,0.221047,23861,-1],[[[[6,8,1]],[[6,8,-1]],[[6,8,1]]],0,8,0.209865,4279,1],[[[[6,6,1],[6,6,-1]]],12,84,0.220425,-470,1],[[[[6,6,1]],[[6,6,-1]]],6,84,0.210801,-16,-1],[[[[49,6,1]],[[49,6,-1]]],15,96,0.222737,5228,-1],[[[[8,26,1],[8,26,-1]]],60,8,0.230551,914,-1]]," +
         "[0.0181903,0.0761542,0.210242,0.213206,0.271327,0.283774,0.265606,0.282749,0.267108,0.286566,0.299632]," +
         "10.5988]" +
         "]";
   */


   // test face
   //const std::string imageFileName = "/mnt/project-disk/src/ObjectRecognition/data/facesTraining/tutorial-haartraining/data/CMU-MIT_Face_Test_Set/newtest/ew-courtney-david.png";

   // test car
   // On Jetson
   // const std::string imageFileName = "/mnt/project-disk/src/ObjectRecognition/data/cars/TheKITTIVision/testing/image_2/000006.png";
   // const std::string imageFileName = "/mnt/project-disk/src/ObjectRecognition/data/cars/TheKITTIVision/testing/image_2/000021.png";

   // test car on host
   const std::string imageFileName = "/media/mona/ObjectRecognitio/data/objectRecognition/cars/TheKITTIVision/data/testing/image_2/000021.png";


   deviceSetup();

   cudaEvent_t start, stop;
   cudaEventCreate(&start);
   cudaEventCreate(&stop);

   Image image;
   Image::fromFile(imageFileName, image);

   std::vector<Classifier::Stage> strongClassifier;
   FeatureTypes featureTypes;
   Classifier::fromResult(strongClassifierStr, strongClassifier, featureTypes);

   std::vector<Classifier::ClassificationResult> results;

   // define all scales for a strong classifier
   std::vector<double> classifierScales;

   //classifierScales.push_back(0.5);
   //classifierScales.push_back(0.75);
   classifierScales.push_back(1.0);
   classifierScales.push_back(1.1);
   classifierScales.push_back(1.2);
   classifierScales.push_back(1.4);
   classifierScales.push_back(1.6);

   // use the defined scales to detect objects
   for (std::vector<double>::const_iterator classifierScalesIter = classifierScales.begin();
         classifierScalesIter != classifierScales.end();
         ++classifierScalesIter)
   {
      std::vector<Classifier::Stage> scaledStrongClassifier;
      FeatureTypes scaledFeatureTypes;
      Classifier::scaleStrongClassifier(*classifierScalesIter, strongClassifier, featureTypes, scaledStrongClassifier, scaledFeatureTypes);
      scaledFeatureTypes.generateClassifier(1.0, image.getWidth(), image.getHeight(), true);
      Classifier::detectStrongClassifier(scaledStrongClassifier, scaledFeatureTypes, image.getGpuIntegralImage(), results);

   }

   image.displayClassificationResult(results);
}

void detectInImageSetAndStore(const std::string & strongClassifierStr)
{
   const cv::String pathTestImages =
         "/media/mona/ObjectRecognitio/data/objectRecognition/cars/TheKITTIVision/data/testing/image_2/*.png";

   const std::string classificationResultFolder =
         "/media/mona/ObjectRecognitio/data/objectRecognition/cars/TheKITTIVision/data/classificationResultsTest";

   uint32_t resultImageWidth = 64;
   uint32_t resultImageHeight = 64;

   std::vector<Classifier::Stage> strongClassifier;
   FeatureTypes featureTypes;
   Classifier::fromResult(strongClassifierStr, strongClassifier, featureTypes);


   // define all scales for a strong classifier
   std::vector<double> classifierScales;

   classifierScales.push_back(0.5);
   classifierScales.push_back(0.75);
   classifierScales.push_back(1.0);
   classifierScales.push_back(1.1);
   classifierScales.push_back(1.2);
   classifierScales.push_back(1.4);
   classifierScales.push_back(1.6);
   classifierScales.push_back(2.0);
   classifierScales.push_back(2.5);
   classifierScales.push_back(3.0);

   // get all file names from test images
   std::vector<cv::String> fileNamesTestImages;
   cv::glob(pathTestImages, fileNamesTestImages, true);

   // classify all all sub images in each test image

   for (uint32_t testImageIdx = 0; testImageIdx < fileNamesTestImages.size(); testImageIdx++)
   {
      const cv::String & testImageFileName = fileNamesTestImages[testImageIdx];
      const std::string testImageBaseName = fileBasename(testImageFileName);

      std::stringstream debugMsg;
      debugMsg << "detectInImageSetAndStore: Image:" << testImageBaseName << " ";
      dumpFreeMemory(debugMsg.str());

      Image testImage;
      Image::fromFile(testImageFileName, testImage);

      // detect strong classifier in each scale in the whole image
      for (std::vector<double>::const_iterator classifierScalesIter = classifierScales.begin();
            classifierScalesIter != classifierScales.end();
            ++classifierScalesIter)
      {
         FeatureTypes scaledFeatureTypes;
         std::vector<Classifier::ClassificationResult> results;
         std::vector<Classifier::Stage> scaledStrongClassifier;
         Classifier::scaleStrongClassifier(*classifierScalesIter, strongClassifier, featureTypes, scaledStrongClassifier, scaledFeatureTypes);
         scaledFeatureTypes.generateClassifier(1.0, testImage.getWidth(), testImage.getHeight(), true);
         Classifier::detectStrongClassifier(scaledStrongClassifier, scaledFeatureTypes, testImage.getGpuIntegralImage(), results);

         //
         //testImage.displayClassificationResult(results);

         testImage.storeClassificationResult(
               testImageBaseName,
               results,
               classificationResultFolder,
               resultImageWidth, resultImageHeight);

      }

      dumpFreeMemory("detectInImageSetAndStore: Image processing done.");
      testImage.release();
      dumpFreeMemory("detectInImageSetAndStore: Release Memory.");
   }
}

/**
 * Host function that prepares data array and passes it to the CUDA kernel.
 */
int main(void)
{

   // car
   const std::string strongClassifierStr = std::string() +
         "[[[[[[[37,9,1]],[[37,9,-1]]],13,43,0.0619337,-11735,1],[[[[11,19,1],[11,19,-1]]],1,39,0.145784,3719,-1],[[[[7,19,1],[7,19,-1]]],45,39,0.225079,-1296,1],[[[[7,12,1],[7,12,-1]]],20,20,0.28414,-146,1],[[[[6,7,1],[6,7,-1]]],46,25,0.298801,537,-1]]," +
         "[0.0660228,0.170665,0.290455,0.396921,0.426128]," +
         "1.23631]," +
         "[[[[[[3,12,1],[3,12,-1]]],23,52,0.115659,-79,-1],[[[[37,9,1]],[[37,9,-1]]],14,43,0.0892886,-17047,1],[[[[7,9,1],[7,9,-1]]],5,41,0.167309,1568,-1],[[[[11,12,1],[11,12,-1]]],40,40,0.233579,-2427,1],[[[[6,4,1]],[[6,4,-1]]],21,16,0.281402,177,-1],[[[[7,11,1]],[[7,11,-1]]],25,42,0.307715,-1357,1],[[[[7,6,1],[7,6,-1]]],45,25,0.296656,773,-1],[[[[9,19,1],[9,19,-1]]],2,42,0.302938,1110,-1]]," +
         "[0.130785,0.0980427,0.200926,0.304767,0.391599,0.444493,0.42178,0.434592]," +
         "3.67837]," +
         "[[[[[[6,12,1],[6,12,-1]]],20,48,0.307783,231,1],[[[[7,9,1]],[[7,9,-1]]],13,43,0.173136,-2654,1],[[[[9,9,1],[9,9,-1]]],44,40,0.199944,-2160,1],[[[[11,9,1],[11,9,-1]]],1,41,0.299815,2459,-1],[[[[46,9,1]],[[46,9,-1]]],18,4,0.313178,-2990,1],[[[[9,5,1],[9,5,-1]]],10,19,0.328205,359,-1],[[[[9,9,1],[9,9,-1]]],24,41,0.327423,-544,-1],[[[[15,9,1]],[[15,9,-1]]],26,34,0.315741,4187,-1],[[[[6,9,1]],[[6,9,-1]]],41,42,0.330355,-498,1],[[[[6,12,1],[6,12,-1]]],21,21,0.350181,-156,1],[[[[12,6,1]],[[12,6,-1]]],26,18,0.342412,912,-1],[[[[6,4,1],[6,4,-1]]],19,49,0.347887,-74,-1]]," +
         "[0.444634,0.209388,0.249913,0.428193,0.455982,0.48855,0.486819,0.461435,0.493329,0.53889,0.520708,0.533477]," +
         "3.6387]," +
         "[[[[[[46,6,1]],[[46,6,-1]]],4,41,0.329141,8120,-1],[[[[9,9,1]],[[9,9,-1]]],41,42,0.188864,-2213,1],[[[[4,15,1],[4,15,-1]]],48,38,0.235415,-567,1],[[[[6,12,1],[6,12,-1]]],6,40,0.28915,1657,-1],[[[[23,14,1]],[[23,14,-1]]],11,22,0.322326,3753,-1],[[[[6,5,1],[6,5,-1]]],20,20,0.329521,-58,1],[[[[19,3,1]],[[19,3,-1]]],20,13,0.353059,-423,1],[[[[3,19,1],[3,19,-1]]],26,45,0.331259,-104,-1],[[[[5,7,1]],[[5,7,-1]]],36,11,0.340362,486,-1],[[[[18,6,1],[18,6,-1]]],25,58,0.35763,-1110,-1],[[[[29,6,1]],[[29,6,-1]]],16,40,0.328843,-6376,1],[[[[3,12,1],[3,12,-1]]],0,45,0.34003,-40,-1],[[[[3,7,1],[3,7,-1]]],12,20,0.346219,128,-1],[[[[2,6,1],[2,6,-1]]],32,46,0.357348,14,1],[[[[46,3,1]],[[46,3,-1]]],6,24,0.335479,-936,1],[[[[3,12,1],[3,12,-1]]],27,44,0.353315,57,1],[[[[14,15,1],[14,15,-1]]],35,30,0.354642,-7836,1]]," +
         "[0.490627,0.232838,0.307898,0.406767,0.475636,0.491471,0.545735,0.495346,0.515983,0.556736,0.489965,0.51522,0.529564,0.556052,0.504844,0.546348,0.549528]," +
         "5.10765]," +
         "[[[[[[11,23,1],[11,23,-1]]],3,41,0.342893,1175,-1],[[[[7,9,1],[7,9,-1]]],46,41,0.253207,-2749,1],[[[[19,9,1]],[[19,9,-1]]],12,42,0.285711,-5866,1],[[[[4,23,1],[4,23,-1]]],8,26,0.326184,2017,-1],[[[[7,6,1]],[[7,6,-1]]],11,36,0.340827,133,-1],[[[[37,6,1]],[[37,6,-1]]],7,15,0.349001,2514,-1],[[[[7,19,1],[7,19,-1]]],21,21,0.355897,-195,1],[[[[6,9,1]],[[6,9,-1]]],39,4,0.349979,-485,1],[[[[3,9,1],[3,9,-1]]],27,39,0.357297,-39,-1],[[[[6,7,1],[6,7,-1]]],45,25,0.341172,801,-1],[[[[3,9,1],[3,9,-1]]],20,49,0.354218,-40,-1],[[[[4,9,1],[4,9,-1]]],45,24,0.351026,-313,1],[[[[3,4,1],[3,4,-1]]],28,37,0.378708,29,1],[[[[29,4,1]],[[29,4,-1]]],17,41,0.352047,2428,-1],[[[[6,4,1],[6,4,-1]]],33,49,0.35968,81,1],[[[[37,7,1]],[[37,7,-1]]],11,39,0.350095,-8536,1],[[[[4,37,1],[4,37,-1]]],32,14,0.361479,-197,-1],[[[[23,2,1]],[[23,2,-1]],[[23,2,1]]],22,42,0.356422,568,1]]," +
         "[0.521823,0.33906,0.399994,0.484084,0.517053,0.536101,0.552547,0.538412,0.555928,0.517847,0.548511,0.540894,0.60955,0.543321,0.561719,0.538686,0.56612,0.553813]," +
         "4.67766]," +
         "[[[[[[4,9,1],[4,9,-1]]],46,54,0.360525,-90,-1],[[[[4,9,1],[4,9,-1]]],48,41,0.255062,-868,1],[[[[11,5,1],[11,5,-1]]],0,43,0.304873,2270,-1],[[[[46,11,1]],[[46,11,-1]]],10,42,0.337718,-21662,1],[[[[4,6,1]],[[4,6,-1]]],30,22,0.350912,-264,1],[[[[3,12,1],[3,12,-1]]],33,45,0.369539,53,1],[[[[29,2,1]],[[29,2,-1]]],18,14,0.349578,-349,1],[[[[7,18,1]],[[7,18,-1]]],14,14,0.367101,1603,-1],[[[[4,6,1]],[[4,6,-1]]],21,11,0.378652,345,-1],[[[[4,19,1],[4,19,-1]]],32,42,0.3673,-224,-1],[[[[29,2,1]],[[29,2,-1]]],20,15,0.364518,-303,1],[[[[7,7,1],[7,7,-1]]],44,42,0.374648,-393,1],[[[[6,12,1],[6,12,-1]]],45,31,0.379693,652,-1],[[[[6,5,1],[6,5,-1]]],48,57,0.361205,-150,-1],[[[[4,5,1],[4,5,-1]]],11,25,0.370302,311,-1],[[[[3,4,1],[3,4,-1]]],28,37,0.378292,-23,-1],[[[[29,3,1]],[[29,3,-1]]],19,45,0.383231,-1743,1],[[[[7,4,1],[7,4,-1]]],20,20,0.385343,-50,1],[[[[46,11,1]],[[46,11,-1]]],7,0,0.39181,-2055,1],[[[[4,5,1],[4,5,-1]]],43,20,0.384696,-166,1],[[[[4,5,1],[4,5,-1]]],1,50,0.378699,-34,-1],[[[[4,6,1],[4,6,-1]]],44,21,0.37598,89,-1],[[[[9,19,1],[9,19,-1]]],46,40,0.382883,-482,1],[[[[29,3,1]],[[29,3,-1]]],16,46,0.365157,917,-1],[[[[3,5,1],[3,5,-1]]],23,35,0.363649,21,1],[[[[15,11,1]],[[15,11,-1]],[[15,11,1]]],27,19,0.37484,7990,1]]," +
         "[0.563783,0.342394,0.438585,0.509931,0.540624,0.58614,0.537462,0.58003,0.609403,0.580528,0.573609,0.599101,0.612105,0.565448,0.588063,0.608472,0.621354,0.626923,0.644223,0.625213,0.609527,0.602512,0.620438,0.575192,0.57146,0.599589]," +
         "6.16073]," +
         "[[[[[[2,23,1],[2,23,-1],[2,23,1]]],8,25,0.380394,2553,-1],[[[[5,6,1]],[[5,6,-1]]],12,46,0.303785,-1087,1],[[[[4,9,1],[4,9,-1]]],8,39,0.32351,438,-1],[[[[11,23,1],[11,23,-1]]],41,39,0.363707,-4745,1],[[[[37,2,1]],[[37,2,-1]],[[37,2,1]]],12,43,0.366829,1087,1],[[[[4,11,1]],[[4,11,-1]]],28,42,0.355361,-664,1],[[[[6,7,1],[6,7,-1]]],7,25,0.358334,-584,1],[[[[3,7,1],[3,7,-1]]],6,50,0.37418,-31,-1],[[[[46,4,1]],[[46,4,-1]]],0,43,0.371512,1495,-1],[[[[5,7,1]],[[5,7,-1]]],24,15,0.374263,119,-1],[[[[7,4,1]],[[7,4,-1]]],45,36,0.378116,152,-1],[[[[29,3,1]],[[29,3,-1]]],17,43,0.386976,-1456,1],[[[[3,4,1],[3,4,-1]]],34,35,0.353888,-25,-1],[[[[4,18,1]],[[4,18,-1]]],0,2,0.392338,-723,1],[[[[7,4,1]],[[7,4,-1]]],15,27,0.385462,69,-1],[[[[3,19,1],[3,19,-1]]],29,43,0.396304,-84,-1],[[[[19,2,1]],[[19,2,-1]]],24,15,0.372542,340,-1],[[[[9,37,1],[9,37,-1]]],19,20,0.376193,621,1],[[[[5,3,1]],[[5,3,-1]]],36,16,0.386393,117,-1],[[[[3,12,1],[3,12,-1]]],24,45,0.387774,-50,-1],[[[[23,2,1]],[[23,2,-1]]],21,16,0.373019,-334,1],[[[[2,29,1],[2,29,-1]]],59,35,0.37859,54,1],[[[[4,6,1],[4,6,-1]]],47,31,0.394447,-466,1],[[[[2,4,1],[2,4,-1]]],32,36,0.39493,8,1],[[[[3,15,1],[3,15,-1]]],47,30,0.378871,154,-1],[[[[3,6,1],[3,6,-1]]],31,35,0.388218,-30,-1],[[[[23,3,1]],[[23,3,-1]]],24,45,0.389471,-2031,1],[[[[9,19,1],[9,19,-1]]],3,41,0.387031,785,-1],[[[[37,3,1]],[[37,3,-1]]],14,48,0.385091,-2876,1],[[[[4,5,1],[4,5,-1]]],40,51,0.393587,42,1],[[[[3,19,1],[3,19,-1]]],12,26,0.397214,-149,1]]," +
         "[0.613928,0.436338,0.478219,0.571603,0.579353,0.551255,0.558444,0.597903,0.591119,0.598116,0.608017,0.631259,0.547718,0.645652,0.627239,0.656464,0.593733,0.60306,0.629709,0.633383,0.594946,0.609244,0.651382,0.652701,0.609972,0.63457,0.637923,0.631404,0.626257,0.64904,0.658964]," +
         "6.59453]," +
         "[[[[[[3,5,1],[3,5,-1]]],29,38,0.385932,24,1],[[[[4,9,1],[4,9,-1]]],8,40,0.32037,972,-1],[[[[4,7,1]],[[4,7,-1]]],46,45,0.332926,-1017,1],[[[[6,3,1]],[[6,3,-1]]],28,25,0.364946,-84,1],[[[[14,12,1],[14,12,-1]]],36,38,0.365642,-5205,1],[[[[6,6,1],[6,6,-1]]],38,19,0.381554,-286,1],[[[[4,4,1]],[[4,4,-1]]],48,23,0.392994,-54,1],[[[[2,15,1],[2,15,-1]]],0,45,0.388648,-15,-1],[[[[12,2,1]],[[12,2,-1]]],33,45,0.384725,-246,1],[[[[4,23,1]],[[4,23,-1]]],30,11,0.380902,-793,-1],[[[[15,3,1]],[[15,3,-1]]],25,43,0.383514,732,-1],[[[[14,4,1],[14,4,-1]]],30,53,0.379818,-723,-1],[[[[9,7,1]],[[9,7,-1]],[[9,7,1]]],29,25,0.387397,752,1],[[[[2,19,1],[2,19,-1]]],25,45,0.383052,44,1],[[[[23,3,1]],[[23,3,-1]]],20,12,0.382319,-993,1],[[[[9,19,1],[9,19,-1]]],5,41,0.387278,792,-1],[[[[3,7,1],[3,7,-1]]],43,19,0.393573,204,-1],[[[[2,15,1],[2,15,-1]]],25,48,0.391264,-23,-1],[[[[3,6,1],[3,6,-1]]],45,20,0.393817,-152,1],[[[[11,15,1],[11,15,-1]]],29,32,0.402564,18,-1],[[[[9,4,1],[9,4,-1]]],2,60,0.40313,262,1],[[[[23,2,1]],[[23,2,-1]]],22,15,0.380156,-447,1],[[[[3,6,1],[3,6,-1]]],34,47,0.387576,25,1],[[[[7,4,1]],[[7,4,-1]]],28,23,0.398602,168,-1],[[[[9,7,1],[9,7,-1]]],10,18,0.402444,708,-1],[[[[2,5,1],[2,5,-1]]],22,35,0.406377,10,1],[[[[11,4,1],[11,4,-1]]],4,25,0.391748,-543,1],[[[[4,5,1],[4,5,-1]]],28,39,0.408351,-56,-1],[[[[15,3,1]],[[15,3,-1]]],28,42,0.397819,-632,1],[[[[3,9,1],[3,9,-1]]],28,40,0.395071,72,1],[[[[3,15,1],[3,15,-1]]],46,30,0.398328,177,-1],[[[[6,12,1],[6,12,-1]]],43,32,0.406622,-424,1],[[[[19,7,1]],[[19,7,-1]]],20,4,0.402873,-654,1],[[[[3,29,1],[3,29,-1]]],24,20,0.40513,-66,1],[[[[19,3,1]],[[19,3,-1]]],22,46,0.404088,-1381,1],[[[[6,9,1],[6,9,-1]]],25,43,0.382576,-240,-1]]," +
         "[0.628485,0.471389,0.499085,0.574668,0.576396,0.616956,0.647431,0.635719,0.625289,0.615253,0.622097,0.61243,0.632379,0.620882,0.61896,0.632062,0.649003,0.642749,0.649666,0.67382,0.675406,0.613308,0.632854,0.662792,0.673482,0.68457,0.644055,0.690192,0.66063,0.653086,0.662034,0.685266,0.674686,0.68104,0.678099,0.619632]," +
         "7.26414]," +
         "[[[[[[4,7,1],[4,7,-1]]],48,42,0.33161,-200,1],[[[[11,12,1],[11,12,-1]]],0,40,0.298817,4201,-1],[[[[46,4,1]],[[46,4,-1]]],6,48,0.325118,-5713,1],[[[[37,7,1]],[[37,7,-1]]],9,14,0.353112,2296,-1],[[[[29,3,1]],[[29,3,-1]]],20,45,0.361447,-1638,1],[[[[7,18,1]],[[7,18,-1]]],43,18,0.374336,83,-1],[[[[4,7,1],[4,7,-1]]],13,17,0.388814,360,-1],[[[[3,9,1],[3,9,-1]]],39,48,0.393847,39,1],[[[[4,4,1],[4,4,-1]]],46,25,0.378039,291,-1],[[[[4,11,1]],[[4,11,-1]]],12,41,0.383549,-681,1],[[[[7,23,1]],[[7,23,-1]]],53,2,0.393871,-1412,1],[[[[4,19,1],[4,19,-1]]],33,20,0.399015,100,-1],[[[[9,6,1]],[[9,6,-1]]],14,42,0.396553,989,-1],[[[[2,6,1],[2,6,-1]]],21,35,0.374794,12,1],[[[[19,2,1]],[[19,2,-1]]],22,44,0.401358,-323,1],[[[[4,5,1],[4,5,-1]]],20,50,0.384025,-48,-1],[[[[29,9,1]],[[29,9,-1]],[[29,9,1]]],22,23,0.404913,9284,1],[[[[3,6,1],[3,6,-1]]],38,38,0.398051,-24,-1],[[[[3,5,1],[3,5,-1]]],47,36,0.40362,120,-1],[[[[11,9,1],[11,9,-1]]],19,15,0.390432,-2194,-1],[[[[19,2,1]],[[19,2,-1]]],24,45,0.392094,401,-1],[[[[9,6,1]],[[9,6,-1]]],25,30,0.392492,284,-1],[[[[2,12,1],[2,12,-1]]],6,41,0.396437,56,1],[[[[3,12,1],[3,12,-1]]],44,39,0.399794,81,-1],[[[[4,4,1],[4,4,-1]]],22,21,0.404547,-15,1],[[[[12,9,1]],[[12,9,-1]]],40,20,0.415595,749,-1],[[[[7,3,1]],[[7,3,-1]]],10,39,0.412394,46,-1],[[[[2,4,1],[2,4,-1]]],26,37,0.409769,8,1],[[[[19,2,1]],[[19,2,-1]]],24,36,0.391345,-255,1],[[[[4,4,1],[4,4,-1]]],22,26,0.39279,-144,-1],[[[[3,6,1],[3,6,-1]]],12,21,0.402818,-190,1],[[[[4,19,1],[4,19,-1]]],2,42,0.394422,-227,-1],[[[[3,5,1],[3,5,-1]]],12,21,0.404649,91,-1],[[[[11,12,1],[11,12,-1]]],4,6,0.41371,-134,1]]," +
         "[0.496133,0.426161,0.481741,0.545864,0.566042,0.598302,0.636162,0.649749,0.607817,0.622188,0.649813,0.663936,0.657147,0.599474,0.670448,0.623442,0.680425,0.661271,0.676782,0.640506,0.644991,0.646068,0.656829,0.666096,0.679393,0.711142,0.70182,0.694251,0.642968,0.646875,0.674532,0.651314,0.679682,0.705641]," +
         "6.65026]," +
         "[[[[[[18,5,1],[18,5,-1]]],6,50,0.394653,1200,1],[[[[6,23,1],[6,23,-1]]],47,40,0.337035,-1563,1],[[[[9,4,1],[9,4,-1]]],10,18,0.368925,317,-1],[[[[4,3,1]],[[4,3,-1]]],10,41,0.389705,25,-1],[[[[6,6,1]],[[6,6,-1]]],18,27,0.396176,78,-1],[[[[23,3,1]],[[23,3,-1]]],21,16,0.39134,1495,-1],[[[[4,9,1],[4,9,-1]]],49,53,0.369939,-171,-1],[[[[23,3,1]],[[23,3,-1]]],18,12,0.371414,1670,-1],[[[[14,12,1],[14,12,-1]]],2,43,0.372219,1301,-1],[[[[19,2,1]],[[19,2,-1]]],29,45,0.3886,-229,1],[[[[7,29,1],[7,29,-1]]],13,30,0.399282,-130,1],[[[[4,12,1],[4,12,-1]]],26,37,0.39338,205,1],[[[[4,5,1],[4,5,-1]]],9,34,0.387964,-127,1],[[[[23,23,1],[23,23,-1]]],0,34,0.397062,4479,-1],[[[[2,4,1],[2,4,-1]]],16,20,0.410258,-15,1],[[[[4,15,1],[4,15,-1]]],54,40,0.403983,291,1],[[[[15,2,1]],[[15,2,-1]]],22,42,0.390387,-178,1],[[[[3,5,1],[3,5,-1]]],30,34,0.396697,53,1],[[[[12,3,1]],[[12,3,-1]]],31,15,0.401192,438,-1],[[[[29,3,1]],[[29,3,-1]]],18,15,0.407555,-348,1],[[[[19,9,1]],[[19,9,-1]]],41,42,0.39679,-795,1],[[[[2,7,1],[2,7,-1]]],16,19,0.404178,52,-1],[[[[6,12,1],[6,12,-1]]],23,22,0.412756,-16,1],[[[[9,11,1]],[[9,11,-1]]],0,1,0.413914,-208,1],[[[[23,3,1]],[[23,3,-1]]],23,47,0.410783,414,-1],[[[[2,12,1],[2,12,-1]]],5,44,0.401816,-21,-1],[[[[23,2,1]],[[23,2,-1]]],20,30,0.409481,-166,1],[[[[14,5,1],[14,5,-1]]],18,41,0.41114,-608,-1],[[[[2,12,1],[2,12,-1]]],49,32,0.40412,67,-1],[[[[7,4,1],[7,4,-1]]],40,31,0.408958,-119,1],[[[[12,7,1]],[[12,7,-1]]],18,32,0.411558,760,-1],[[[[11,5,1],[11,5,-1]]],35,4,0.420226,-672,-1],[[[[29,2,1]],[[29,2,-1]]],18,41,0.406298,-285,1],[[[[4,9,1],[4,9,-1]]],30,44,0.400791,113,1],[[[[4,5,1],[4,5,-1]]],46,24,0.411544,329,-1],[[[[15,18,1]],[[15,18,-1]]],7,18,0.412086,11831,1],[[[[19,2,1]],[[19,2,-1]]],25,15,0.403473,405,-1],[[[[3,4,1],[3,4,-1]]],1,43,0.4052,-32,-1],[[[[29,3,1]],[[29,3,-1]]],16,46,0.412614,-3671,1],[[[[3,12,1],[3,12,-1]]],32,43,0.400118,-81,-1],[[[[2,9,1],[2,9,-1]]],49,25,0.413798,-49,1],[[[[9,15,1],[9,15,-1]]],15,38,0.415665,-57,1],[[[[4,3,1]],[[4,3,-1]]],18,27,0.419712,29,-1],[[[[2,19,1],[2,19,-1]]],60,39,0.424028,21,1],[[[[11,9,1],[11,9,-1],[11,9,1]]],15,35,0.412564,15859,-1],[[[[4,23,1]],[[4,23,-1]]],37,11,0.395775,-1697,-1],[[[[15,2,1]],[[15,2,-1]]],26,17,0.409969,-358,1]]," +
         "[0.651944,0.508375,0.584597,0.638551,0.656112,0.642954,0.587149,0.590871,0.592911,0.635591,0.664674,0.648478,0.633892,0.658544,0.695658,0.677804,0.640385,0.657542,0.669984,0.687921,0.657798,0.678354,0.702871,0.706235,0.697167,0.671726,0.693426,0.698196,0.67819,0.691927,0.699402,0.72481,0.684347,0.668867,0.699364,0.700928,0.676369,0.681237,0.702458,0.666996,0.705896,0.711346,0.723281,0.736196,0.702314,0.655012,0.694828]," +
         "8.51124]," +
         "[[[[[[2,37,1],[2,37,-1]]],25,24,0.162347,-280,-1],[[[[6,6,1],[6,6,-1]]],47,44,0.330184,-1812,1],[[[[37,7,1]],[[37,7,-1]]],8,14,0.365264,1791,-1],[[[[4,7,1],[4,7,-1]]],7,34,0.380064,667,-1],[[[[5,9,1]],[[5,9,-1]]],23,42,0.381372,-887,1],[[[[6,2,1]],[[6,2,-1]]],27,25,0.377337,-25,1],[[[[4,4,1],[4,4,-1]]],33,21,0.397051,39,-1],[[[[9,6,1]],[[9,6,-1]]],20,24,0.400222,-65,1],[[[[7,7,1],[7,7,-1]]],10,32,0.391827,468,-1],[[[[7,6,1]],[[7,6,-1]]],44,13,0.399562,-78,1],[[[[6,4,1],[6,4,-1]]],44,60,0.401399,-54,-1],[[[[12,4,1]],[[12,4,-1]]],26,42,0.390761,551,-1],[[[[6,7,1]],[[6,7,-1]]],38,27,0.391621,-52,-1],[[[[23,2,1]],[[23,2,-1]]],15,25,0.39466,132,-1],[[[[4,7,1]],[[4,7,-1]]],46,34,0.389158,40,-1],[[[[29,3,1]],[[29,3,-1]]],15,12,0.399486,1421,-1],[[[[4,5,1],[4,5,-1]]],24,37,0.387371,44,1],[[[[2,15,1],[2,15,-1]]],46,35,0.408018,32,-1],[[[[7,4,1],[7,4,-1]]],43,41,0.398881,-229,1],[[[[29,2,1]],[[29,2,-1]]],15,47,0.402916,96,-1],[[[[3,9,1],[3,9,-1]]],32,42,0.392707,79,1],[[[[37,2,1]],[[37,2,-1]]],14,47,0.390646,-1096,1],[[[[3,9,1],[3,9,-1]]],19,49,0.400444,-44,-1],[[[[2,4,1],[2,4,-1]]],44,20,0.407741,-81,1],[[[[4,2,1]],[[4,2,-1]],[[4,2,1]]],4,9,0.398162,605,1],[[[[3,4,1],[3,4,-1]]],44,21,0.405064,115,-1],[[[[6,15,1],[6,15,-1]]],8,44,0.407101,132,-1],[[[[23,6,1]],[[23,6,-1]]],10,39,0.406554,-3574,1],[[[[14,9,1],[14,9,-1]]],19,31,0.406331,-1071,-1],[[[[3,12,1],[3,12,-1]]],47,36,0.414496,110,-1],[[[[2,29,1],[2,29,-1]]],53,29,0.408227,-64,-1],[[[[18,23,1],[18,23,-1]]],28,39,0.410576,-2895,1],[[[[3,12,1],[3,12,-1]]],11,31,0.408219,-121,1],[[[[9,12,1],[9,12,-1]]],33,32,0.408195,-41,-1],[[[[15,3,1]],[[15,3,-1]]],6,2,0.412763,3,-1],[[[[5,11,1]],[[5,11,-1]]],56,40,0.416695,-1957,-1],[[[[19,2,1]],[[19,2,-1]]],22,29,0.39758,-253,1],[[[[4,12,1],[4,12,-1]]],47,52,0.39831,-226,-1],[[[[12,6,1]],[[12,6,-1]]],28,34,0.402533,-1062,1],[[[[3,4,1],[3,4,-1]]],26,44,0.401243,-28,-1],[[[[23,2,1]],[[23,2,-1]]],18,29,0.408091,138,-1],[[[[18,37,1],[18,37,-1]]],14,23,0.414945,2175,1],[[[[6,3,1]],[[6,3,-1]]],11,38,0.414633,26,-1],[[[[6,6,1]],[[6,6,-1]]],20,4,0.415715,-187,1],[[[[2,23,1],[2,23,-1]]],30,40,0.421099,-25,-1],[[[[23,3,1]],[[23,3,-1]]],21,47,0.399709,-2566,1],[[[[4,6,1],[4,6,-1]]],27,17,0.407053,-130,-1],[[[[7,12,1],[7,12,-1],[7,12,1]]],24,27,0.409971,5635,1]]," +
         "[0.193812,0.492948,0.575459,0.61307,0.61648,0.606005,0.658514,0.667284,0.64427,0.665451,0.670561,0.641392,0.643712,0.651964,0.637083,0.665239,0.63231,0.68924,0.663564,0.674806,0.646651,0.641082,0.6679,0.68845,0.661577,0.680854,0.686627,0.685072,0.68444,0.707931,0.689837,0.69657,0.689813,0.689746,0.70289,0.714368,0.659971,0.661984,0.673732,0.670127,0.68945,0.709242,0.708329,0.711493,0.727412,0.665858,0.68649,0.694831]," +
         "10.0343]," +
         "[[[[[[14,6,1],[14,6,-1]]],15,17,0.177554,-2570,-1],[[[[9,11,1]],[[9,11,-1]]],24,42,0.243879,-1011,1],[[[[6,23,1],[6,23,-1]]],21,13,0.323184,-1025,1],[[[[6,4,1]],[[6,4,-1]]],49,24,0.353969,-78,1],[[[[15,9,1]],[[15,9,-1]]],31,13,0.359609,423,-1],[[[[4,23,1],[4,23,-1]]],48,40,0.37833,-948,1],[[[[6,3,1]],[[6,3,-1]]],15,39,0.387232,33,-1],[[[[4,9,1],[4,9,-1]]],28,16,0.386324,-4,1],[[[[2,6,1],[2,6,-1]]],11,26,0.39374,23,-1],[[[[3,4,1],[3,4,-1]]],23,26,0.374952,-65,-1],[[[[3,4,1],[3,4,-1]]],48,26,0.381693,94,-1],[[[[3,19,1],[3,19,-1]]],54,40,0.384575,211,1],[[[[3,5,1],[3,5,-1]]],14,21,0.382322,199,-1],[[[[12,14,1]],[[12,14,-1]]],50,1,0.389759,446,1],[[[[3,4,1],[3,4,-1]]],17,16,0.3996,-21,1],[[[[4,6,1]],[[4,6,-1]]],7,41,0.397733,1,-1],[[[[18,5,1],[18,5,-1]]],20,51,0.386936,-1173,-1],[[[[2,4,1],[2,4,-1],[2,4,1]]],14,42,0.39687,52,1],[[[[7,9,1],[7,9,-1],[7,9,1]]],1,19,0.391213,3747,-1],[[[[9,2,1]],[[9,2,-1]]],33,4,0.396094,1,-1],[[[[9,7,1]],[[9,7,-1]]],27,3,0.39239,-212,1],[[[[4,15,1],[4,15,-1]]],17,31,0.404953,-40,1],[[[[3,6,1],[3,6,-1]]],41,50,0.402903,30,1],[[[[2,6,1],[2,6,-1]]],49,30,0.392812,51,-1],[[[[3,19,1],[3,19,-1]]],2,41,0.399214,-127,-1],[[[[23,2,1]],[[23,2,-1]]],37,27,0.39139,28,-1],[[[[3,5,1],[3,5,-1]]],50,35,0.402115,-39,1],[[[[4,23,1]],[[4,23,-1]]],21,9,0.407441,3192,1],[[[[2,12,1],[2,12,-1]]],10,34,0.388686,-48,1],[[[[4,5,1],[4,5,-1]]],9,8,0.391296,124,1],[[[[5,4,1]],[[5,4,-1]]],53,21,0.399099,41,-1],[[[[9,9,1]],[[9,9,-1]]],35,24,0.400964,-802,-1],[[[[6,7,1]],[[6,7,-1]]],2,31,0.396738,-819,1],[[[[2,29,1],[2,29,-1]]],5,35,0.399675,98,1],[[[[15,3,1]],[[15,3,-1]]],23,15,0.393436,248,-1],[[[[5,3,1]],[[5,3,-1]]],8,30,0.40919,32,-1],[[[[7,6,1],[7,6,-1]]],46,16,0.40399,-792,-1],[[[[7,4,1]],[[7,4,-1]]],24,46,0.390518,155,-1],[[[[2,29,1],[2,29,-1]]],56,35,0.397769,-68,-1],[[[[3,4,1],[3,4,-1]]],47,25,0.400146,-52,1],[[[[6,7,1]],[[6,7,-1]]],16,15,0.409824,1171,1],[[[[23,2,1]],[[23,2,-1]]],20,17,0.396614,-193,1]]," +
         "[0.215885,0.322541,0.477506,0.547913,0.561545,0.60857,0.631939,0.629523,0.649458,0.599878,0.617319,0.624893,0.618966,0.638697,0.665557,0.660392,0.631151,0.658017,0.642611,0.655887,0.645793,0.68054,0.674771,0.646937,0.664485,0.643088,0.672563,0.687596,0.635821,0.642835,0.664167,0.669347,0.657653,0.665764,0.64863,0.692592,0.677823,0.640737,0.660492,0.667074,0.69441,0.657313]," +
         "10.2038]," +
         "[[[[[[11,5,1],[11,5,-1]]],12,52,0.148646,1595,1],[[[[4,23,1]],[[4,23,-1]]],24,11,0.155358,-2592,-1],[[[[6,7,1],[6,7,-1]]],37,19,0.332444,-219,1],[[[[4,19,1],[4,19,-1]]],49,42,0.331509,-334,1],[[[[4,19,1],[4,19,-1]]],11,16,0.338344,478,-1],[[[[15,6,1]],[[15,6,-1]]],22,24,0.355604,-251,1],[[[[29,3,1]],[[29,3,-1]]],11,56,0.357158,-328,-1],[[[[2,4,1],[2,4,-1]]],12,36,0.358513,-11,1],[[[[4,3,1]],[[4,3,-1]]],33,58,0.346633,34,1],[[[[6,18,1]],[[6,18,-1]]],1,17,0.365945,-157,1],[[[[5,4,1]],[[5,4,-1]]],49,24,0.372668,-42,1],[[[[6,4,1]],[[6,4,-1]]],17,27,0.35734,5,-1],[[[[6,19,1],[6,19,-1]]],1,9,0.376049,226,-1],[[[[7,4,1],[7,4,-1]]],4,0,0.373378,304,1],[[[[9,2,1]],[[9,2,-1]]],49,39,0.369014,8,-1],[[[[6,15,1],[6,15,-1]]],19,38,0.372913,65,1],[[[[3,5,1],[3,5,-1]]],56,18,0.375216,-23,1],[[[[7,6,1],[7,6,-1]]],45,58,0.368995,-145,-1],[[[[2,12,1],[2,12,-1]]],57,6,0.36465,13,-1],[[[[12,3,1]],[[12,3,-1]]],49,6,0.372363,-156,-1],[[[[6,2,1]],[[6,2,-1]]],43,22,0.370121,7,-1],[[[[3,12,1],[3,12,-1]]],49,52,0.380083,12,1],[[[[2,9,1],[2,9,-1]]],42,14,0.370399,28,-1],[[[[4,5,1],[4,5,-1]]],19,38,0.359516,-74,-1],[[[[2,46,1],[2,46,-1]]],34,13,0.372423,12,-1],[[[[3,19,1],[3,19,-1]]],17,31,0.374867,-21,1],[[[[9,3,1]],[[9,3,-1]]],11,34,0.373126,37,-1],[[[[2,4,1],[2,4,-1]]],40,36,0.374435,5,1],[[[[4,6,1]],[[4,6,-1]]],60,47,0.366697,-17,-1],[[[[2,12,1],[2,12,-1]]],48,30,0.37658,30,-1]]," +
         "[0.174599,0.183934,0.498002,0.495907,0.511359,0.551841,0.555592,0.558879,0.530533,0.57715,0.594051,0.556032,0.602689,0.595859,0.58482,0.594674,0.600552,0.584773,0.573937,0.593277,0.587606,0.61312,0.588306,0.561319,0.593431,0.59966,0.595218,0.598556,0.579023,0.604056]," +
         "9.93031]," +
         "[[[[[[4,4,1],[4,4,-1]]],18,24,0.127678,-288,-1],[[[[14,6,1],[14,6,-1]]],12,32,0.0620815,4003,1],[[[[4,4,1],[4,4,-1]]],33,38,0.268191,21,1],[[[[4,11,1]],[[4,11,-1]]],20,9,0.267079,97,-1],[[[[11,4,1],[11,4,-1]]],37,14,0.27585,-8,-1],[[[[29,9,1]],[[29,9,-1]]],27,29,0.275332,4326,-1],[[[[23,9,1]],[[23,9,-1]]],1,30,0.270434,4120,1],[[[[3,4,1],[3,4,-1]]],43,1,0.302967,-6,-1],[[[[2,4,1],[2,4,-1]]],37,51,0.293875,9,1],[[[[6,15,1],[6,15,-1]]],34,32,0.27152,333,-1],[[[[6,6,1],[6,6,-1]]],41,26,0.306728,-205,1],[[[[2,7,1],[2,7,-1]]],22,22,0.276555,-29,-1],[[[[6,2,1]],[[6,2,-1]]],42,28,0.311574,7,-1]]," +
         "[0.146365,0.0661907,0.366478,0.364404,0.380929,0.379942,0.370678,0.434652,0.41618,0.372722,0.442434,0.382276,0.452589]," +
         "8.34515]," +
         "[[[[[[4,4,1],[4,4,-1]]],26,47,0.0929181,-129,-1],[[[[7,7,1],[7,7,-1],[7,7,1]]],25,28,0.0203829,-51,-1],[[[[4,9,1]],[[4,9,-1]]],36,11,0.118417,-5,-1],[[[[23,6,1],[23,6,-1]]],10,18,0.205509,2463,1],[[[[2,4,1],[2,4,-1]]],38,20,0.201678,20,1],[[[[29,9,1]],[[29,9,-1]]],11,0,0.195937,-3710,-1]]," +
         "[0.102436,0.0208071,0.134323,0.258668,0.252627,0.243684]," +
         "7.50319]," +
         "[[[[[[12,18,1]],[[12,18,-1]]],36,18,0.0373901,13162,1],[[[[19,6,1]],[[19,6,-1]]],45,35,0.00254182,7213,1],[[[[9,7,1]],[[9,7,-1]]],25,23,0.0323413,2825,1]]," +
         "[0.0388424,0.00254829,0.0334223]," +
         "9.22057]" +
         "]";

   detectInImageSetAndStore(strongClassifierStr);
	return 0;
}
