/*
 *
 *  Created on: May 17, 2017
 *      Author: Mario LÃ¼der
 *
 */

#include <stdio.h>
#include <stdlib.h>


#include "Learner.cuh"
#include "Classifier.cuh"
#include "FeatureTypes.cuh"
#include "FeatureValues.cuh"
#include "Image.cuh"

// load image includes
#include <opencv2/core/core.hpp>
#include <opencv2/highgui/highgui.hpp>

#include <cuda_profiler_api.h>

#include "utilities.cuh"
#include "defines.cuh"

/**
 * Host function that prepares data array and passes it to the CUDA kernel.
 */
int main(void)
{
   // Original
   // std::string strongClassifierStr = "[[[[[[[49,22,1]],[[49,22,-1]]],18,0,0.0332471,-90686,1],[[[[12,36,1],[12,36,-1]]],0,12,0.0991827,-9593,1]],[0.0343905,0.110103],2.20634],[[[[[[16,66,1],[16,66,-1]]],57,20,0.108966,29552,-1],[[[[14,16,1]],[[14,16,-1]]],72,64,0.160855,3968,-1],[[[[26,4,1]],[[26,4,-1]]],33,100,0.183328,1901,-1],[[[[29,36,1],[29,36,-1]]],33,8,0.1819,25689,-1],[[[[4,6,1],[4,6,-1]]],84,0,0.169853,44211,1]],[0.122292,0.191689,0.224481,0.222345,0.204606],5.09883],[[[[[[26, 29, 1]], [[26, 29, -1]]], 18, 32, 0.0191388, 34104, 1],[[[[26, 3, 1]], [[26, 3, -1]], [[26, 3, 1]]], 21, 52, 0.0207317, 8115, -1]], [0.0195122, 0.0211706], 6.79186]]";

   //std::string strongClassifierStr = "[[[[[[[49,22,1]],[[49,22,-1]]],18,0,0.0332471,-90686,1],[[[[12,36,1],[12,36,-1]]],0,12,0.0991827,-9593,1]],[0.0343905,0.110103],2.20634],[[[[[[16,66,1],[16,66,-1]]],57,20,0.108966,29552,-1],[[[[14,16,1]],[[14,16,-1]]],72,64,0.160855,3968,-1],[[[[26,4,1]],[[26,4,-1]]],33,100,0.183328,1901,-1],[[[[29,36,1],[29,36,-1]]],33,8,0.1819,25689,-1],[[[[4,6,1],[4,6,-1]]],84,0,0.169853,44211,1]],[0.122292,0.191689,0.224481,0.222345,0.204606],5.09883],[[[[[[26, 29, 1]], [[26, 29, -1]]], 18, 32, 0.0191388, 34104, 1],[[[[26, 3, 1]], [[26, 3, -1]], [[26, 3, 1]]], 21, 52, 0.0207317, 8115, -1]], [0.0195122, 0.0211706], 7.78186]]";
   /*
   [[[[[[[49,22,1]],[[49,22,-1]]],18,0,0.0332471,-90686,1],[[[[22,8,1],[22,8,-1]]],48,104,0.0922494,-38536,1],[[[[8,26,1],[8,26,-1]]],0,20,0.144086,-6474,1],[[[[10,22,1]],[[10,22,-1]],[[10,22,1]]],0,32,0.160434,18853,1],[[[[26,4,1]],[[26,4,-1]]],30,100,0.154933,1657,-1]],
   [0.0343905,0.101624,0.168342,0.191091,0.183338],
   3.35143],
   [[[[[[49,22,1]],[[49,22,-1]]],6,0,0.176727,-40517,1],[[[[12,66,1],[12,66,-1]]],66,24,0.187417,21526,-1],[[[[14,16,1]],[[14,16,-1]]],75,64,0.194728,3836,-1],[[[[12,36,1],[12,36,-1]]],0,56,0.23373,-8190,1],[[[[22,66,1],[22,66,-1]]],39,0,0.228247,21777,-1],[[[[49,6,1]],[[49,6,-1]]],9,0,0.228516,-7595,1],[[[[49,6,1]],[[49,6,-1]]],18,52,0.236501,-3840,1],[[[[26,12,1]],[[26,12,-1]]],0,64,0.225154,2591,-1],[[[[49,3,1]],[[49,3,-1]]],21,48,0.265981,-921,1],[[[[6,3,1]],[[6,3,-1]]],39,104,0.264232,57,-1],[[[[14,3,1]],[[14,3,-1]]],6,104,0.265039,-136,1],[[[[10,22,1]],[[10,22,-1]],[[10,22,1]]],78,36,0.252234,16527,1],[[[[2,6,1],[2,6,-1]]],69,100,0.242955,396,-1]],
   [0.214664,0.230644,0.241816,0.305022,0.295752,0.296203,0.309759,0.290579,0.362362,0.359124,0.360616,0.337317,0.320925],
   7.37621],
   [[[[[[49,4,1]],[[49,4,-1]],[[49,4,1]]],42,0,0.0261283,29220,1],[[[[12,26,1],[12,26,-1],[12,26,1]]],39,32,0.0710643,28378,-1],[[[[2,26,1],[2,26,-1]]],72,12,0.11069,52,-1],[[[[29,36,1],[29,36,-1]]],24,48,0.104579,1347,-1],[[[[8,36,1],[8,36,-1]]],24,20,0.0969391,1184,1]],
   [0.0268293,0.0765008,0.124468,0.116793,0.107345],
   8.33607]
   ]
   */


   /* faces
   std::string strongClassifierStr = std::string() +
         "[[[[[[[49,22,1]],[[49,22,-1]]],18,0,0.0332471,-90686,1],[[[[12,36,1],[12,36,-1]]],0,12,0.0991827,-9593,1],[[[[16,6,1],[16,6,-1]]],57,84,0.148353,2177,-1]]," +
         "[0.0343905,0.110103,0.174196]," +
         "1.74758]," +
         "[[[[[[8,12,1]],[[8,12,-1]]],84,64,0.0523191,-7807,1],[[[[14,16,1]],[[14,16,-1]]],33,12,0.0340082,-27205,1],[[[[22,36,1],[22,36,-1]]],45,12,0.114434,21409,-1],[[[[14,22,1]],[[14,22,-1]]],12,0,0.189615,-7194,1],[[[[26,4,1]],[[26,4,-1]]],30,100,0.165921,1563,-1],[[[[6,12,1]],[[6,12,-1]]],81,88,0.183366,66521,1]]," +
         "[0.0552076,0.0352054,0.129221,0.233982,0.198927,0.224539]," +
         "5.84288]," +
         "[[[[[[12,26,1],[12,26,-1],[12,26,1]]],36,76,0.0178653,22526,-1],[[[[2,10,1],[2,10,-1]]],3,20,0.0707651,-591,1],[[[[12,26,1],[12,26,-1]]],0,72,0.173719,-2579,1],[[[[49,16,1]],[[49,16,-1]]],27,0,0.175738,-24893,1],[[[[10,4,1]],[[10,4,-1]]],72,80,0.21342,181,-1],[[[[29,49,1],[29,49,-1]]],30,56,0.221047,23861,-1],[[[[6,8,1]],[[6,8,-1]],[[6,8,1]]],0,8,0.209865,4279,1],[[[[6,6,1],[6,6,-1]]],12,84,0.220425,-470,1],[[[[6,6,1]],[[6,6,-1]]],6,84,0.210801,-16,-1],[[[[49,6,1]],[[49,6,-1]]],15,96,0.222737,5228,-1],[[[[8,26,1],[8,26,-1]]],60,8,0.230551,914,-1]]," +
         "[0.0181903,0.0761542,0.210242,0.213206,0.271327,0.283774,0.265606,0.282749,0.267108,0.286566,0.299632]," +
         "10.5988]" +
         "]";
   */

   const std::string strongClassifierStr = std::string() +
         "[[[[[[[37,11,1]],[[37,11,-1]]],14,42,0.0595272,-15271,1],[[[[11,12,1],[11,12,-1]]],2,40,0.158305,3102,-1],[[[[6,19,1],[6,19,-1]]],46,38,0.238811,-1000,1],[[[[7,5,1],[7,5,-1]]],20,20,0.301596,-128,1],[[[[6,9,1],[6,9,-1]]],46,24,0.301625,675,-1]]," +
         "[0.0632949,0.188079,0.313734,0.431835,0.431895]," +
         "1.15921]," +
         "[[[[[[3,9,1],[3,9,-1]]],48,54,0.103802,-77,-1],[[[[9,7,1],[9,7,-1]]],44,42,0.102237,-3615,1],[[[[23,11,1]],[[23,11,-1]]],12,42,0.176579,-6523,1],[[[[7,15,1],[7,15,-1]]],4,34,0.253183,2848,-1],[[[[6,23,1],[6,23,-1]]],46,40,0.269307,-1184,1],[[[[7,11,1]],[[7,11,-1]]],12,28,0.290526,687,-1],[[[[23,6,1]],[[23,6,-1]]],24,8,0.307513,-1301,1],[[[[7,15,1],[7,15,-1]]],20,20,0.315926,-225,1],[[[[7,9,1]],[[7,9,-1]]],42,40,0.338357,-1736,1],[[[[4,12,1],[4,12,-1]]],20,48,0.30816,-117,-1],[[[[4,7,1]],[[4,7,-1]]],16,40,0.295122,615,-1]]," +
         "[0.115825,0.11388,0.214446,0.339016,0.368563,0.409495,0.444071,0.461831,0.511389,0.445421,0.418686]," +
         "4.82897]," +
         "[[[[[[11,23,1],[11,23,-1]]],2,38,0.300367,1247,-1],[[[[6,12,1],[6,12,-1]]],46,40,0.199872,-2077,1],[[[[37,9,1]],[[37,9,-1]]],12,42,0.224747,-12749,1],[[[[29,7,1]],[[29,7,-1]]],14,12,0.297078,3097,-1],[[[[9,15,1],[9,15,-1]]],0,40,0.331291,1341,-1],[[[[37,4,1]],[[37,4,-1]]],16,24,0.334887,-1199,1],[[[[9,37,1],[9,37,-1]]],20,20,0.326302,598,1],[[[[23,3,1]],[[23,3,-1]]],14,14,0.347254,-366,1],[[[[4,12,1],[4,12,-1]]],26,42,0.323282,-166,-1],[[[[19,2,1]],[[19,2,-1]],[[19,2,1]]],24,42,0.337573,448,1],[[[[46,11,1]],[[46,11,-1]]],6,0,0.34667,-2171,1],[[[[3,12,1],[3,12,-1]]],48,50,0.343476,49,1],[[[[37,7,1]],[[37,7,-1]]],8,38,0.337831,9570,-1],[[[[2,29,1],[2,29,-1]]],34,32,0.330568,-47,-1],[[[[7,9,1],[7,9,-1]]],10,32,0.336559,687,-1]]," +
         "[0.42932,0.2498,0.289902,0.422633,0.495418,0.503503,0.484345,0.53199,0.47772,0.5096,0.53062,0.523173,0.510189,0.493804,0.507294]," +
         "4.63824]," +
         "[[[[[[7,5,1],[7,5,-1]]],18,20,0.366654,-100,1],[[[[6,6,1],[6,6,-1]]],6,42,0.233807,962,-1],[[[[5,11,1]],[[5,11,-1]]],46,42,0.264482,-1836,1],[[[[14,7,1],[14,7,-1]]],36,42,0.301792,-2349,1],[[[[9,4,1],[9,4,-1]]],12,20,0.33337,337,-1],[[[[7,4,1],[7,4,-1]]],38,22,0.354781,-222,1],[[[[23,6,1],[23,6,-1]]],16,58,0.360446,-757,-1],[[[[37,6,1]],[[37,6,-1]]],14,42,0.34077,-8629,1],[[[[6,12,1],[6,12,-1]]],32,48,0.343204,210,1],[[[[37,6,1]],[[37,6,-1]]],8,40,0.323635,8423,-1],[[[[3,12,1],[3,12,-1]]],0,44,0.334519,-51,-1],[[[[9,7,1]],[[9,7,-1]]],26,30,0.365083,628,-1],[[[[2,7,1],[2,7,-1]]],44,18,0.374686,43,-1],[[[[3,9,1],[3,9,-1]]],24,48,0.354275,-50,-1],[[[[2,4,1],[2,4,-1]]],44,20,0.36856,-17,1],[[[[4,15,1],[4,15,-1]]],22,36,0.362933,79,1],[[[[7,15,1],[7,15,-1]]],44,26,0.372968,1823,-1],[[[[2,19,1],[2,19,-1]]],36,40,0.352414,-29,-1],[[[[6,9,1],[6,9,-1]]],44,28,0.358367,-1420,1],[[[[6,9,1],[6,9,-1]]],28,44,0.35507,237,1],[[[[23,4,1]],[[23,4,-1]]],14,48,0.370743,-4133,1],[[[[6,37,1],[6,37,-1]]],28,20,0.345821,-339,-1]]," +
         "[0.578916,0.305154,0.359585,0.432237,0.500082,0.54986,0.563591,0.516922,0.522542,0.478492,0.502673,0.57501,0.599198,0.548648,0.583681,0.569695,0.594815,0.544196,0.558524,0.550556,0.589175,0.528634]," +
         "6.05845]," +
         "[[[[[[3,19,1],[3,19,-1]]],46,30,0.368218,122,-1],[[[[6,12,1],[6,12,-1]]],46,40,0.264143,-1294,1],[[[[7,7,1]],[[7,7,-1]]],12,44,0.270638,-1482,1],[[[[37,6,1]],[[37,6,-1]]],10,16,0.320965,2382,-1],[[[[11,19,1],[11,19,-1]]],0,40,0.345606,2301,-1],[[[[23,4,1]],[[23,4,-1]]],20,14,0.338453,2378,-1],[[[[4,5,1],[4,5,-1]]],24,36,0.361417,38,1],[[[[4,4,1]],[[4,4,-1]]],48,24,0.361711,-100,1],[[[[4,14,1]],[[4,14,-1]]],32,22,0.371746,510,-1],[[[[4,12,1],[4,12,-1]]],10,22,0.37685,463,-1],[[[[3,5,1],[3,5,-1]]],30,36,0.36691,30,1],[[[[6,7,1],[6,7,-1]]],8,24,0.362605,-493,1],[[[[3,15,1],[3,15,-1]]],24,46,0.364591,91,1],[[[[29,2,1]],[[29,2,-1]]],18,44,0.359037,-481,1],[[[[2,19,1],[2,19,-1]]],26,44,0.35827,-32,-1],[[[[46,3,1]],[[46,3,-1]]],4,12,0.370691,-1239,1],[[[[14,15,1],[14,15,-1]]],18,32,0.369054,-1642,-1],[[[[4,12,1],[4,12,-1]]],8,32,0.376703,960,-1],[[[[4,5,1],[4,5,-1]]],26,48,0.377991,60,1],[[[[37,9,1]],[[37,9,-1]],[[37,9,1]]],12,36,0.368737,57287,-1],[[[[4,23,1],[4,23,-1]]],56,40,0.374305,221,1],[[[[4,4,1],[4,4,-1],[4,4,1]]],34,42,0.376457,229,1],[[[[7,19,1],[7,19,-1]]],22,20,0.384088,-152,1],[[[[46,11,1]],[[46,11,-1]]],14,0,0.388232,-2126,1],[[[[2,9,1],[2,9,-1]]],14,18,0.383942,56,-1],[[[[11,12,1],[11,12,-1]]],20,14,0.382839,-1832,-1],[[[[5,7,1]],[[5,7,-1]]],18,40,0.378027,-1396,1],[[[[9,23,1]],[[9,23,-1]]],40,10,0.392747,209,-1],[[[[46,3,1]],[[46,3,-1]]],2,44,0.377369,820,-1],[[[[9,4,1],[9,4,-1]]],40,60,0.386091,-203,-1],[[[[4,12,1],[4,12,-1]]],46,22,0.380883,-638,1]]," +
         "[0.582824,0.35896,0.371062,0.472678,0.528131,0.511608,0.565968,0.566688,0.591714,0.60475,0.579555,0.568886,0.57379,0.560152,0.558289,0.589045,0.584923,0.604372,0.607693,0.584126,0.598224,0.603739,0.623609,0.634606,0.623225,0.620322,0.607787,0.646761,0.606088,0.628907,0.615203]," +
         "7.47904]," +
         "[[[[[[4,4,1]],[[4,4,-1]]],12,38,0.395318,-3,-1],[[[[4,12,1],[4,12,-1]]],48,40,0.29374,-1108,1],[[[[37,9,1]],[[37,9,-1]]],14,44,0.331943,-16046,1],[[[[11,7,1],[11,7,-1]]],0,40,0.334542,3597,-1],[[[[7,12,1],[7,12,-1]]],36,18,0.376929,-433,1],[[[[6,3,1]],[[6,3,-1]]],16,28,0.383926,50,-1],[[[[5,11,1]],[[5,11,-1]]],26,42,0.384753,-789,1],[[[[29,3,1]],[[29,3,-1]]],16,44,0.36227,-1937,1],[[[[7,4,1],[7,4,-1]]],20,20,0.372707,-86,1],[[[[4,12,1],[4,12,-1]]],32,44,0.385597,112,1],[[[[9,7,1]],[[9,7,-1]]],26,22,0.371379,-805,1],[[[[9,19,1],[9,19,-1]]],4,42,0.393,1039,-1],[[[[23,3,1]],[[23,3,-1]]],20,14,0.369489,-1144,1],[[[[3,15,1],[3,15,-1]]],32,44,0.371205,-70,-1],[[[[19,4,1]],[[19,4,-1]]],22,14,0.380832,893,-1],[[[[4,9,1],[4,9,-1]]],38,50,0.393718,72,1],[[[[19,2,1]],[[19,2,-1]]],24,16,0.374413,-292,1],[[[[3,5,1],[3,5,-1]]],30,36,0.379268,-36,-1],[[[[2,15,1],[2,15,-1]]],48,28,0.388973,70,-1],[[[[9,9,1],[9,9,-1]]],40,36,0.38422,-540,1],[[[[9,19,1],[9,19,-1]]],32,30,0.393801,188,-1],[[[[29,2,1]],[[29,2,-1]]],18,44,0.402448,513,-1],[[[[2,7,1],[2,7,-1]]],30,36,0.368671,18,1],[[[[2,6,1],[2,6,-1]]],44,18,0.400432,37,-1],[[[[4,6,1],[4,6,-1]]],26,38,0.397193,-34,-1],[[[[4,14,1]],[[4,14,-1]]],0,2,0.402516,-469,1],[[[[3,7,1],[3,7,-1]]],6,50,0.41062,-14,-1],[[[[15,2,1]],[[15,2,-1]],[[15,2,1]]],18,44,0.385765,154,1],[[[[9,4,1],[9,4,-1]]],44,56,0.380625,-341,-1],[[[[29,2,1]],[[29,2,-1]]],24,46,0.3931,-432,1],[[[[9,19,1],[9,19,-1]]],46,40,0.403737,-643,1],[[[[3,15,1],[3,15,-1]]],48,28,0.390882,288,-1],[[[[2,9,1],[2,9,-1]]],40,50,0.387965,-19,-1],[[[[15,3,1]],[[15,3,-1]]],22,42,0.398996,-1092,1],[[[[4,23,1]],[[4,23,-1]]],24,10,0.382149,-638,-1],[[[[3,4,1],[3,4,-1]]],44,20,0.402632,-113,1],[[[[2,15,1],[2,15,-1]]],58,48,0.399947,-27,-1],[[[[9,2,1]],[[9,2,-1]]],28,16,0.401859,55,-1],[[[[4,29,1],[4,29,-1]]],16,24,0.409725,-71,1],[[[[3,9,1],[3,9,-1]]],26,38,0.410159,62,1]]," +
         "[0.653761,0.41591,0.496877,0.502725,0.604954,0.623181,0.625363,0.568062,0.594152,0.627596,0.590785,0.647448,0.586014,0.590342,0.61507,0.649399,0.5985,0.611,0.63659,0.623955,0.649624,0.673494,0.583959,0.667867,0.658905,0.673686,0.696698,0.628041,0.614532,0.647717,0.677112,0.641718,0.633893,0.663883,0.618514,0.674009,0.666519,0.671847,0.694127,0.695374]," +
         "8.45963]," +
         "[[[[[[11,12,1],[11,12,-1]]],40,40,0.323129,-1794,1],[[[[4,9,1],[4,9,-1]]],8,40,0.262019,600,-1],[[[[46,7,1]],[[46,7,-1]]],8,46,0.310198,-15716,1],[[[[9,3,1]],[[9,3,-1]]],44,38,0.361688,88,-1],[[[[7,11,1]],[[7,11,-1]]],28,42,0.376767,-1365,1],[[[[46,6,1]],[[46,6,-1]]],2,40,0.358616,9610,-1],[[[[3,12,1],[3,12,-1]]],24,48,0.370044,-56,-1],[[[[37,7,1]],[[37,7,-1]]],12,38,0.374261,-7705,1],[[[[11,15,1],[11,15,-1]]],0,44,0.367698,1073,-1],[[[[9,9,1]],[[9,9,-1]]],36,2,0.380048,-496,1],[[[[7,7,1],[7,7,-1]]],12,18,0.382903,411,-1],[[[[3,5,1],[3,5,-1]]],16,18,0.39097,-89,1],[[[[2,15,1],[2,15,-1]]],26,46,0.370005,36,1],[[[[11,15,1],[11,15,-1],[11,15,1]]],16,30,0.383019,5904,1],[[[[4,23,1]],[[4,23,-1]]],60,6,0.398525,-1191,1],[[[[2,12,1],[2,12,-1]]],32,38,0.385658,23,1],[[[[7,12,1],[7,12,-1]]],4,22,0.378222,-476,1],[[[[4,23,1],[4,23,-1]]],32,16,0.389281,-95,-1],[[[[3,6,1],[3,6,-1]]],48,24,0.386232,168,-1],[[[[12,6,1]],[[12,6,-1]]],14,16,0.393377,281,-1],[[[[4,5,1],[4,5,-1],[4,5,1]]],42,26,0.398346,1059,-1],[[[[3,19,1],[3,19,-1]]],48,24,0.395271,-488,1],[[[[6,4,1]],[[6,4,-1]]],10,40,0.399451,72,-1],[[[[4,4,1],[4,4,-1]]],30,42,0.401842,-33,-1],[[[[3,4,1],[3,4,-1]]],46,24,0.394344,100,-1],[[[[2,15,1],[2,15,-1]]],26,40,0.398405,-25,-1],[[[[29,3,1]],[[29,3,-1]]],24,46,0.393311,-2351,1],[[[[7,12,1],[7,12,-1]]],20,36,0.389916,94,1],[[[[29,3,1]],[[29,3,-1]]],16,46,0.405305,576,-1],[[[[3,15,1],[3,15,-1]]],0,46,0.380339,-74,-1],[[[[19,11,1]],[[19,11,-1]],[[19,11,1]]],26,18,0.402195,8533,1],[[[[6,6,1]],[[6,6,-1]]],16,26,0.400885,78,-1]]," +
         "[0.477386,0.355048,0.449691,0.566631,0.604537,0.559128,0.587411,0.59811,0.581522,0.613028,0.62049,0.641955,0.587313,0.620796,0.662578,0.627759,0.60829,0.637415,0.629279,0.648471,0.662085,0.653634,0.665144,0.671799,0.651103,0.662248,0.64829,0.639119,0.681534,0.613787,0.672787,0.66913]," +
         "6.88581]," +
         "[[[[[[9,4,1],[9,4,-1]]],0,60,0.200571,671,1],[[[[7,9,1],[7,9,-1]]],46,40,0.312112,-1674,1],[[[[4,23,1],[4,23,-1]]],8,28,0.353343,2056,-1],[[[[5,7,1]],[[5,7,-1]]],12,34,0.363303,295,-1],[[[[6,7,1]],[[6,7,-1]]],34,12,0.378747,214,-1],[[[[23,3,1]],[[23,3,-1]]],24,14,0.375647,-423,1],[[[[9,29,1],[9,29,-1]]],20,18,0.382167,80,1],[[[[4,3,1]],[[4,3,-1]]],32,22,0.390008,46,-1],[[[[3,23,1],[3,23,-1]]],26,34,0.393992,-143,-1],[[[[15,3,1]],[[15,3,-1]]],30,14,0.370202,864,-1],[[[[7,6,1],[7,6,-1]]],26,16,0.387142,-347,-1],[[[[4,6,1]],[[4,6,-1]]],42,26,0.381738,257,-1],[[[[4,4,1]],[[4,4,-1]]],48,40,0.403402,10,-1],[[[[9,2,1]],[[9,2,-1]]],24,30,0.397217,-64,1],[[[[3,5,1],[3,5,-1]]],34,34,0.386878,-31,-1],[[[[6,12,1],[6,12,-1]]],6,26,0.388601,-1185,1],[[[[9,7,1]],[[9,7,-1]]],32,30,0.383631,268,-1],[[[[3,5,1],[3,5,-1]]],10,30,0.403564,38,-1],[[[[3,4,1],[3,4,-1]]],32,38,0.404591,25,1],[[[[23,3,1]],[[23,3,-1]]],18,42,0.390793,1175,-1],[[[[3,12,1],[3,12,-1]]],22,52,0.391759,-62,-1],[[[[3,9,1],[3,9,-1]]],46,26,0.392326,-137,1],[[[[3,29,1],[3,29,-1]]],46,26,0.399021,159,-1],[[[[9,7,1]],[[9,7,-1]]],16,26,0.391029,-375,-1],[[[[5,9,1]],[[5,9,-1]]],0,28,0.400125,-751,1],[[[[2,9,1],[2,9,-1]]],22,52,0.401876,15,1],[[[[15,3,1]],[[15,3,-1]]],18,12,0.395098,822,-1],[[[[5,23,1]],[[5,23,-1]]],30,10,0.387458,4819,1],[[[[5,3,1]],[[5,3,-1]]],30,12,0.39828,-71,1],[[[[2,12,1],[2,12,-1]]],0,48,0.410664,1,-1],[[[[23,2,1]],[[23,2,-1]]],26,26,0.412966,90,-1],[[[[2,4,1],[2,4,-1]]],20,36,0.397896,7,1],[[[[11,9,1],[11,9,-1]]],4,6,0.407508,-319,1],[[[[4,19,1],[4,19,-1]]],32,28,0.414065,18,-1],[[[[19,2,1]],[[19,2,-1]]],16,44,0.41479,-300,1],[[[[2,5,1],[2,5,-1]]],28,42,0.388479,-11,-1],[[[[19,2,1]],[[19,2,-1]]],20,18,0.404963,432,-1],[[[[3,23,1],[3,23,-1]]],28,40,0.391438,131,1],[[[[7,4,1],[7,4,-1],[7,4,1]]],40,42,0.403498,2660,-1],[[[[29,11,1]],[[29,11,-1]],[[29,11,1]]],24,18,0.40403,17568,1],[[[[4,19,1],[4,19,-1]]],28,42,0.402817,-211,-1],[[[[29,3,1]],[[29,3,-1]]],14,24,0.401752,917,-1],[[[[2,6,1],[2,6,-1]]],4,48,0.400924,-15,-1],[[[[6,5,1],[6,5,-1]]],46,34,0.401151,378,-1],[[[[23,29,1],[23,29,-1]]],18,34,0.40709,256,1],[[[[9,19,1],[9,19,-1]]],34,30,0.403504,263,-1],[[[[5,4,1]],[[5,4,-1]]],28,30,0.405552,63,-1],[[[[23,9,1]],[[23,9,-1]]],0,2,0.410844,-326,1],[[[[19,2,1]],[[19,2,-1]]],20,28,0.410823,92,-1],[[[[14,7,1],[14,7,-1]]],34,2,0.402982,-1489,-1]]," +
         "[0.250893,0.453726,0.546416,0.570607,0.60965,0.601657,0.618561,0.639365,0.650143,0.587811,0.631699,0.617439,0.67617,0.658973,0.630997,0.635594,0.622404,0.676626,0.679519,0.641479,0.644084,0.645618,0.66395,0.642114,0.667013,0.671895,0.653161,0.632541,0.661904,0.696826,0.70348,0.660842,0.687786,0.706674,0.708788,0.635267,0.680567,0.643218,0.67644,0.677938,0.674529,0.671546,0.669237,0.66987,0.686597,0.676458,0.682233,0.697344,0.697284,0.674992]," +
         "10.9464]," +
         "[[[[[[3,6,1],[3,6,-1]]],20,56,0.112441,-102,-1],[[[[6,12,1],[6,12,-1]]],6,40,0.257775,862,-1],[[[[6,29,1],[6,29,-1]]],22,20,0.350425,-218,1],[[[[6,7,1],[6,7,-1]]],38,18,0.350765,-299,1],[[[[14,7,1],[14,7,-1]]],36,32,0.360798,-5204,1],[[[[4,9,1]],[[4,9,-1]]],30,44,0.338497,-269,1],[[[[4,4,1],[4,4,-1]]],10,36,0.359196,-85,1],[[[[2,12,1],[2,12,-1]]],34,30,0.354169,-32,-1],[[[[46,2,1]],[[46,2,-1]]],10,26,0.364498,-306,1],[[[[2,9,1],[2,9,-1]]],36,22,0.378006,-26,-1],[[[[23,3,1]],[[23,3,-1]]],18,46,0.373611,344,-1],[[[[9,23,1],[9,23,-1],[9,23,1]]],6,20,0.36052,30931,1],[[[[2,12,1],[2,12,-1]]],14,22,0.364689,64,-1],[[[[2,15,1],[2,15,-1]]],6,44,0.380358,-20,-1],[[[[3,19,1],[3,19,-1]]],46,36,0.376703,144,-1],[[[[4,4,1],[4,4,-1]]],42,52,0.376253,53,1],[[[[15,2,1]],[[15,2,-1]]],24,40,0.374492,-100,1],[[[[4,9,1],[4,9,-1]]],42,48,0.366325,-237,-1],[[[[6,3,1]],[[6,3,-1]]],44,30,0.373966,97,-1],[[[[2,5,1],[2,5,-1]]],36,46,0.380848,-8,-1],[[[[23,3,1]],[[23,3,-1]]],20,12,0.381322,685,-1],[[[[4,4,1],[4,4,-1]]],20,26,0.371002,-114,-1],[[[[5,11,1]],[[5,11,-1]]],36,0,0.374034,-178,1],[[[[15,3,1]],[[15,3,-1]]],40,36,0.387595,93,-1],[[[[6,5,1],[6,5,-1]]],44,42,0.390539,-167,1],[[[[29,3,1]],[[29,3,-1]]],14,46,0.362154,314,-1],[[[[3,7,1],[3,7,-1]]],38,38,0.381109,-53,-1],[[[[46,2,1]],[[46,2,-1]]],16,54,0.388263,-131,-1],[[[[4,3,1]],[[4,3,-1]]],30,44,0.380935,156,-1],[[[[7,5,1],[7,5,-1]]],6,46,0.373803,201,-1],[[[[19,7,1]],[[19,7,-1]]],10,30,0.387464,678,-1],[[[[2,5,1],[2,5,-1]]],10,2,0.38486,-5,1],[[[[7,6,1]],[[7,6,-1]]],14,32,0.393281,1399,1],[[[[2,6,1],[2,6,-1]]],12,34,0.368554,-21,1],[[[[11,29,1],[11,29,-1]]],8,18,0.390911,2604,-1],[[[[23,37,1],[23,37,-1]]],4,12,0.396557,24124,1],[[[[6,3,1]],[[6,3,-1]]],22,46,0.373759,-395,1],[[[[14,6,1],[14,6,-1]]],18,30,0.381668,-432,-1]]," +
         "[0.126686,0.3473,0.539468,0.540273,0.564451,0.511708,0.56054,0.548393,0.57356,0.607732,0.596452,0.563771,0.574033,0.613834,0.604372,0.603215,0.598701,0.578097,0.597358,0.615112,0.616349,0.589829,0.597531,0.632905,0.640793,0.567776,0.615792,0.63469,0.61534,0.596942,0.632558,0.625645,0.648209,0.583668,0.641795,0.657157,0.59683,0.617254]," +
         "11.203]," +
         "[[[[[[6,12,1],[6,12,-1]]],6,8,0.109897,2891,1],[[[[12,6,1]],[[12,6,-1]]],8,24,0.0848744,-2615,-1],[[[[4,23,1],[4,23,-1]]],48,36,0.246886,-846,1],[[[[9,3,1]],[[9,3,-1]]],28,50,0.270494,-255,1],[[[[12,18,1]],[[12,18,-1]]],48,4,0.280063,5238,1],[[[[6,19,1],[6,19,-1]]],24,16,0.306685,-4,1],[[[[3,5,1],[3,5,-1]]],40,46,0.309532,2,1],[[[[3,9,1],[3,9,-1]]],16,40,0.30876,1,1],[[[[4,7,1],[4,7,-1]]],46,54,0.316357,-80,-1],[[[[6,2,1]],[[6,2,-1]]],26,26,0.297488,-11,1],[[[[4,4,1],[4,4,-1],[4,4,1]]],20,44,0.325788,647,1],[[[[3,7,1],[3,7,-1],[3,7,1]]],14,16,0.31679,1276,-1],[[[[5,4,1]],[[5,4,-1]],[[5,4,1]]],2,30,0.315465,2268,1],[[[[4,9,1],[4,9,-1]]],46,34,0.3056,-258,1],[[[[7,5,1],[7,5,-1],[7,5,1]]],28,28,0.324898,1459,-1]]," +
         "[0.123465,0.0927461,0.32782,0.37079,0.38901,0.442346,0.448293,0.446677,0.462752,0.423462,0.483213,0.463678,0.460845,0.440091,0.481258]," +
         "8.54974]," +
         "[[[[[[3,7,1],[3,7,-1]]],40,48,0.085944,140,1],[[[[2,23,1],[2,23,-1]]],4,38,0.0276235,429,1],[[[[2,6,1],[2,6,-1]]],32,48,0.166577,4,1],[[[[4,2,1]],[[4,2,-1]]],52,56,0.204699,16,1],[[[[4,7,1],[4,7,-1],[4,7,1]]],14,46,0.187037,2604,1],[[[[4,6,1],[4,6,-1]]],8,42,0.225655,303,-1],[[[[3,9,1],[3,9,-1]]],48,54,0.219325,-54,-1]]," +
         "[0.0940249,0.0284083,0.199871,0.257385,0.230068,0.291415,0.280942]," +
         "8.51546]," +
         "[[[[[[3,6,1],[3,6,-1]]],18,42,0.0213536,186,1],[[[[6,29,1],[6,29,-1]]],52,20,0.000286103,8661,1],[[[[4,4,1]],[[4,4,-1]]],54,48,0.0468292,-385,-1]]," +
         "[0.0218195,0.000286185,0.04913]," +
         "11.1722]" +
         "]";




   // test face
   //const std::string imageFileName = "/mnt/project-disk/src/ObjectRecognition/data/facesTraining/tutorial-haartraining/data/CMU-MIT_Face_Test_Set/newtest/ew-courtney-david.png";

   // test car
   const std::string imageFileName = "/mnt/project-disk/src/ObjectRecognition/data/cars/TheKITTIVision/testing/image_2/000006.png";

   deviceSetup();

   cudaEvent_t start, stop;
   cudaEventCreate(&start);
   cudaEventCreate(&stop);

   Image image;
   Image::fromFile(imageFileName, image);

   std::vector<Classifier::Stage> strongClassifier;
   FeatureTypes featureTypes;
   Classifier::fromResult(strongClassifierStr, strongClassifier, featureTypes);

   std::vector<Classifier::ClassificationResult> results;

   // define all scales for a strong classifier
   std::vector<double> classifierScales;

   //classifierScales.push_back(0.5);
   //classifierScales.push_back(0.75);
   classifierScales.push_back(1.0);
   classifierScales.push_back(1.1);
   classifierScales.push_back(1.2);
   classifierScales.push_back(1.4);
   classifierScales.push_back(1.6);

   // use the defined scales to detect objects
   for (std::vector<double>::const_iterator classifierScalesIter = classifierScales.begin();
         classifierScalesIter != classifierScales.end();
         ++classifierScalesIter)
   {
      std::vector<Classifier::Stage> scaledStrongClassifier;
      FeatureTypes scaledFeatureTypes;
      Classifier::scaleStrongClassifier(*classifierScalesIter, strongClassifier, featureTypes, scaledStrongClassifier, scaledFeatureTypes);
      scaledFeatureTypes.generateClassifier(1.0, image.getWidth(), image.getHeight(), true);
      Classifier::detectStrongClassifier(scaledStrongClassifier, scaledFeatureTypes, image.getGpuIntegralImage(), results);

   }

   image.displayClassificationResult(results);

	return 0;
}
