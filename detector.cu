/*
 *
 *  Created on: May 17, 2017
 *      Author: Mario LÃ¼der
 *
 */

#include <stdio.h>
#include <stdlib.h>


#include "Learner.cuh"
#include "Classifier.cuh"
#include "FeatureTypes.cuh"
#include "FeatureValues.cuh"
#include "Image.cuh"

// load image includes
#include <opencv2/core/core.hpp>
#include <opencv2/highgui/highgui.hpp>

#include <cuda_profiler_api.h>

#include "utilities.cuh"
#include "defines.cuh"


void detectInImageAndDisplay(const std::string & strongClassifierStr)
{
   /* faces
   std::string strongClassifierStr = std::string() +
         "[[[[[[[49,22,1]],[[49,22,-1]]],18,0,0.0332471,-90686,1],[[[[12,36,1],[12,36,-1]]],0,12,0.0991827,-9593,1],[[[[16,6,1],[16,6,-1]]],57,84,0.148353,2177,-1]]," +
         "[0.0343905,0.110103,0.174196]," +
         "1.74758]," +
         "[[[[[[8,12,1]],[[8,12,-1]]],84,64,0.0523191,-7807,1],[[[[14,16,1]],[[14,16,-1]]],33,12,0.0340082,-27205,1],[[[[22,36,1],[22,36,-1]]],45,12,0.114434,21409,-1],[[[[14,22,1]],[[14,22,-1]]],12,0,0.189615,-7194,1],[[[[26,4,1]],[[26,4,-1]]],30,100,0.165921,1563,-1],[[[[6,12,1]],[[6,12,-1]]],81,88,0.183366,66521,1]]," +
         "[0.0552076,0.0352054,0.129221,0.233982,0.198927,0.224539]," +
         "5.84288]," +
         "[[[[[[12,26,1],[12,26,-1],[12,26,1]]],36,76,0.0178653,22526,-1],[[[[2,10,1],[2,10,-1]]],3,20,0.0707651,-591,1],[[[[12,26,1],[12,26,-1]]],0,72,0.173719,-2579,1],[[[[49,16,1]],[[49,16,-1]]],27,0,0.175738,-24893,1],[[[[10,4,1]],[[10,4,-1]]],72,80,0.21342,181,-1],[[[[29,49,1],[29,49,-1]]],30,56,0.221047,23861,-1],[[[[6,8,1]],[[6,8,-1]],[[6,8,1]]],0,8,0.209865,4279,1],[[[[6,6,1],[6,6,-1]]],12,84,0.220425,-470,1],[[[[6,6,1]],[[6,6,-1]]],6,84,0.210801,-16,-1],[[[[49,6,1]],[[49,6,-1]]],15,96,0.222737,5228,-1],[[[[8,26,1],[8,26,-1]]],60,8,0.230551,914,-1]]," +
         "[0.0181903,0.0761542,0.210242,0.213206,0.271327,0.283774,0.265606,0.282749,0.267108,0.286566,0.299632]," +
         "10.5988]" +
         "]";
   */


   // test face
   //const std::string imageFileName = "/mnt/project-disk/src/ObjectRecognition/data/facesTraining/tutorial-haartraining/data/CMU-MIT_Face_Test_Set/newtest/ew-courtney-david.png";

   // test car
   // On Jetson
   // const std::string imageFileName = "/mnt/project-disk/src/ObjectRecognition/data/cars/TheKITTIVision/testing/image_2/000006.png";
   // const std::string imageFileName = "/mnt/project-disk/src/ObjectRecognition/data/cars/TheKITTIVision/testing/image_2/000021.png";

   // test car on host
   const std::string imageFileName = "/media/mona/ObjectRecognitio/data/objectRecognition/cars/TheKITTIVision/data/testing/image_2/000021.png";


   deviceSetup();

   cudaEvent_t start, stop;
   cudaEventCreate(&start);
   cudaEventCreate(&stop);

   Image image;
   Image::fromFile(imageFileName, image);

   std::vector<Classifier::Stage> strongClassifier;
   FeatureTypes featureTypes;
   Classifier::fromResult(strongClassifierStr, strongClassifier, featureTypes);

   std::vector<Classifier::ClassificationResult> results;

   // define all scales for a strong classifier
   std::vector<double> classifierScales;

   //classifierScales.push_back(0.5);
   //classifierScales.push_back(0.75);
   classifierScales.push_back(1.0);
   classifierScales.push_back(1.1);
   classifierScales.push_back(1.2);
   classifierScales.push_back(1.4);
   classifierScales.push_back(1.6);

   // use the defined scales to detect objects
   for (std::vector<double>::const_iterator classifierScalesIter = classifierScales.begin();
         classifierScalesIter != classifierScales.end();
         ++classifierScalesIter)
   {
      std::vector<Classifier::Stage> scaledStrongClassifier;
      FeatureTypes scaledFeatureTypes;
      Classifier::scaleStrongClassifier(*classifierScalesIter, strongClassifier, featureTypes, scaledStrongClassifier, scaledFeatureTypes);
      scaledFeatureTypes.generateClassifier(1.0, image.getWidth(), image.getHeight(), true);
      Classifier::detectStrongClassifier(scaledStrongClassifier, scaledFeatureTypes, image.getGpuIntegralImage(), results);

   }

   image.displayClassificationResult(results);
}

void detectInImageSetAndStore(const std::string & strongClassifierStr)
{
   const cv::String pathTestImages =
         "/media/mona/ObjectRecognitio/data/objectRecognition/cars/TheKITTIVision/data/testing/image_2/*.png";

   const std::string classificationResultFolder =
         "/media/mona/ObjectRecognitio/data/objectRecognition/cars/TheKITTIVision/data/classificationResultsTest";

   uint32_t resultImageWidth = 64;
   uint32_t resultImageHeight = 64;

   std::vector<Classifier::Stage> strongClassifier;
   FeatureTypes featureTypes;
   Classifier::fromResult(strongClassifierStr, strongClassifier, featureTypes);


   // define all scales for a strong classifier
   std::vector<double> classifierScales;

   classifierScales.push_back(0.5);
   classifierScales.push_back(0.75);
   classifierScales.push_back(1.0);
   classifierScales.push_back(1.1);
   classifierScales.push_back(1.2);
   classifierScales.push_back(1.4);
   classifierScales.push_back(1.6);
   classifierScales.push_back(2.0);
   classifierScales.push_back(2.5);
   classifierScales.push_back(3.0);

   // get all file names from test images
   std::vector<cv::String> fileNamesTestImages;
   cv::glob(pathTestImages, fileNamesTestImages, true);

   // classify all all sub images in each test image

   for (uint32_t testImageIdx = 0; testImageIdx < fileNamesTestImages.size(); testImageIdx++)
   {
      const cv::String & testImageFileName = fileNamesTestImages[testImageIdx];
      const std::string testImageBaseName = fileBasename(testImageFileName);

      std::stringstream debugMsg;
      debugMsg << "detectInImageSetAndStore: Image:" << testImageBaseName << " ";
      dumpFreeMemory(debugMsg.str());

      Image testImage;
      Image::fromFile(testImageFileName, testImage);

      // detect strong classifier in each scale in the whole image
      for (std::vector<double>::const_iterator classifierScalesIter = classifierScales.begin();
            classifierScalesIter != classifierScales.end();
            ++classifierScalesIter)
      {
         FeatureTypes scaledFeatureTypes;
         std::vector<Classifier::ClassificationResult> results;
         std::vector<Classifier::Stage> scaledStrongClassifier;
         Classifier::scaleStrongClassifier(*classifierScalesIter, strongClassifier, featureTypes, scaledStrongClassifier, scaledFeatureTypes);
         scaledFeatureTypes.generateClassifier(1.0, testImage.getWidth(), testImage.getHeight(), true);
         Classifier::detectStrongClassifier(scaledStrongClassifier, scaledFeatureTypes, testImage.getGpuIntegralImage(), results);

         //
         //testImage.displayClassificationResult(results);

         testImage.storeClassificationResult(
               testImageBaseName,
               results,
               classificationResultFolder,
               resultImageWidth, resultImageHeight);

      }

      dumpFreeMemory("detectInImageSetAndStore: Image processing done.");
      testImage.release();
      dumpFreeMemory("detectInImageSetAndStore: Release Memory.");
   }
}

/**
 * Host function that prepares data array and passes it to the CUDA kernel.
 */
int main(void)
{

   // car
   const std::string strongClassifierStr = std::string() +
         "[[[[[[[37,11,1]],[[37,11,-1]]],12,42,0.0637033,-16541,1],[[[[9,12,1],[9,12,-1]]],4,40,0.143831,2155,-1],[[[[6,19,1],[6,19,-1]]],46,38,0.234012,-1040,1],[[[[7,12,1],[7,12,-1]]],20,20,0.289658,-146,1],[[[[6,7,1],[6,7,-1]]],46,26,0.296355,632,-1]]," +
         "[0.0680375,0.167993,0.305504,0.407772,0.421172]," +
         "1.18579]," +
         "[[[[[[2,12,1],[2,12,-1]]],24,52,0.110073,-28,-1],[[[[37,7,1]],[[37,7,-1]]],12,44,0.0887522,-13006,1],[[[[9,9,1],[9,9,-1]]],44,40,0.181879,-2270,1],[[[[11,19,1],[11,19,-1]]],0,38,0.203371,3600,-1],[[[[6,11,1]],[[6,11,-1]]],26,42,0.26366,-1099,1],[[[[46,7,1]],[[46,7,-1]]],10,50,0.279737,-13429,1],[[[[7,12,1],[7,12,-1]]],20,20,0.282004,-146,1],[[[[46,9,1]],[[46,9,-1]]],12,2,0.306152,-1530,1]]," +
         "[0.123687,0.0973963,0.222314,0.25529,0.358069,0.388381,0.392765,0.441238]," +
         "3.9352]," +
         "[[[[[[4,6,1],[4,6,-1]]],38,52,0.311664,44,1],[[[[37,9,1]],[[37,9,-1]]],12,42,0.188643,-14877,1],[[[[6,12,1],[6,12,-1]]],6,40,0.207962,1684,-1],[[[[4,12,1],[4,12,-1]]],48,40,0.265587,-512,1],[[[[5,4,1]],[[5,4,-1]]],22,16,0.314515,131,-1],[[[[12,14,1]],[[12,14,-1]]],8,24,0.316754,1589,-1],[[[[12,11,1]],[[12,11,-1]]],30,42,0.330017,-2044,1],[[[[19,6,1]],[[19,6,-1]]],6,40,0.328413,2393,-1],[[[[9,23,1],[9,23,-1]]],28,34,0.324916,-836,-1]]," +
         "[0.452779,0.232503,0.262566,0.361631,0.45882,0.463602,0.492574,0.48901,0.481298]," +
         "2.93385]," +
         "[[[[[[9,19,1],[9,19,-1]]],4,42,0.338797,858,-1],[[[[7,9,1],[7,9,-1]]],46,40,0.218394,-2408,1],[[[[12,9,1]],[[12,9,-1]]],12,42,0.273592,-3619,1],[[[[37,4,1]],[[37,4,-1]]],16,24,0.305901,-1092,1],[[[[7,18,1]],[[7,18,-1]]],42,14,0.330986,1007,-1],[[[[4,23,1],[4,23,-1]]],8,26,0.346316,2025,-1],[[[[7,5,1],[7,5,-1]]],30,48,0.31635,158,1],[[[[19,6,1]],[[19,6,-1]]],26,8,0.33733,-1241,1],[[[[6,19,1],[6,19,-1]]],22,20,0.353159,-175,1],[[[[19,2,1]],[[19,2,-1]],[[19,2,1]]],24,42,0.352636,480,1],[[[[6,4,1],[6,4,-1]]],46,58,0.328149,-104,-1],[[[[6,6,1],[6,6,-1]]],46,26,0.339571,638,-1]]," +
         "[0.512394,0.279416,0.376637,0.440717,0.494737,0.52979,0.462737,0.509047,0.545976,0.544726,0.488426,0.514167]," +
         "3.35935]," +
         "[[[[[[7,7,1],[7,7,-1]]],44,42,0.332426,-376,1],[[[[11,7,1],[11,7,-1]]],0,42,0.253166,3544,-1],[[[[4,9,1]],[[4,9,-1]]],46,44,0.287944,-1633,1],[[[[37,6,1]],[[37,6,-1]]],10,16,0.344102,2155,-1],[[[[9,6,1],[9,6,-1]]],10,20,0.364322,466,-1],[[[[37,6,1]],[[37,6,-1]]],14,42,0.36047,-7956,1],[[[[6,12,1],[6,12,-1]]],26,44,0.331746,364,1],[[[[12,11,1]],[[12,11,-1]]],28,30,0.344742,4105,-1],[[[[4,12,1],[4,12,-1]]],30,44,0.353038,-164,-1],[[[[11,12,1],[11,12,-1]]],40,30,0.33968,-7023,1],[[[[3,6,1],[3,6,-1]]],24,36,0.36334,27,1],[[[[4,4,1],[4,4,-1]]],42,20,0.365317,-129,1],[[[[2,12,1],[2,12,-1]]],24,52,0.376358,24,1],[[[[37,6,1]],[[37,6,-1]]],12,40,0.359162,10255,-1],[[[[4,23,1],[4,23,-1]]],26,40,0.354511,-275,-1],[[[[23,2,1]],[[23,2,-1]]],20,44,0.366063,-417,1],[[[[4,4,1],[4,4,-1]]],28,38,0.35903,48,1],[[[[3,15,1],[3,15,-1]]],46,30,0.368172,177,-1],[[[[7,29,1],[7,29,-1]]],28,14,0.373848,-508,-1]]," +
         "[0.497962,0.338985,0.404384,0.524627,0.573123,0.563649,0.496437,0.526116,0.545686,0.514417,0.570697,0.575589,0.603485,0.560458,0.549212,0.577443,0.560136,0.582709,0.597055]," +
         "4.76517]," +
         "[[[[[[29,2,1]],[[29,2,-1]]],22,46,0.368414,-426,1],[[[[11,12,1],[11,12,-1]]],42,40,0.250863,-4115,1],[[[[9,12,1],[9,12,-1]]],0,40,0.3013,1773,-1],[[[[46,4,1]],[[46,4,-1]]],8,48,0.32926,-6224,1],[[[[4,11,1]],[[4,11,-1]]],26,42,0.35509,-678,1],[[[[5,4,1]],[[5,4,-1]]],48,24,0.353365,-91,1],[[[[19,4,1]],[[19,4,-1]]],22,14,0.379368,1048,-1],[[[[4,9,1],[4,9,-1]]],22,48,0.354043,-91,-1],[[[[29,3,1]],[[29,3,-1]]],18,14,0.35407,-698,1],[[[[7,46,1],[7,46,-1]]],28,18,0.358892,-453,-1],[[[[3,5,1],[3,5,-1]]],12,22,0.377017,115,-1],[[[[9,37,1],[9,37,-1]]],20,20,0.361835,382,1],[[[[6,6,1],[6,6,-1]]],8,24,0.376954,-476,1],[[[[3,9,1],[3,9,-1]]],0,46,0.359708,-51,-1],[[[[6,15,1],[6,15,-1]]],8,30,0.3683,2012,-1],[[[[29,9,1]],[[29,9,-1]]],18,2,0.380752,-1375,1],[[[[7,4,1],[7,4,-1]]],24,38,0.384938,-96,-1],[[[[7,9,1],[7,9,-1]]],44,34,0.368409,739,-1],[[[[2,15,1],[2,15,-1]]],34,44,0.368347,26,1],[[[[4,12,1],[4,12,-1]]],46,22,0.36774,-522,1],[[[[9,4,1],[9,4,-1]]],2,60,0.385177,224,1],[[[[4,5,1],[4,5,-1]]],46,24,0.369004,330,-1],[[[[15,14,1]],[[15,14,-1]]],12,22,0.378573,2079,-1],[[[[6,4,1],[6,4,-1]]],20,20,0.387643,-41,1]]," +
         "[0.583315,0.334869,0.431229,0.490892,0.550603,0.546468,0.611261,0.548092,0.548156,0.5598,0.60518,0.566992,0.605019,0.561788,0.58303,0.614862,0.625853,0.583304,0.583147,0.581627,0.626484,0.584796,0.609199,0.633035]," +
         "5.77303]," +
         "[[[[[[23,2,1]],[[23,2,-1]],[[23,2,1]]],22,42,0.396184,387,1],[[[[6,15,1],[6,15,-1]]],6,40,0.265404,1248,-1],[[[[4,7,1]],[[4,7,-1]]],46,44,0.315509,-873,1],[[[[4,12,1],[4,12,-1]]],48,40,0.33592,-1135,1],[[[[5,6,1]],[[5,6,-1]]],30,22,0.375264,-184,1],[[[[2,15,1],[2,15,-1]]],30,48,0.371282,-26,-1],[[[[29,4,1]],[[29,4,-1]]],22,42,0.352586,-2632,1],[[[[4,15,1],[4,15,-1]]],30,38,0.361636,160,1],[[[[46,4,1]],[[46,4,-1]]],2,42,0.364216,2434,-1],[[[[3,5,1],[3,5,-1]]],22,36,0.370416,28,1],[[[[29,2,1]],[[29,2,-1]]],16,14,0.380589,-206,1],[[[[9,12,1],[9,12,-1]]],38,32,0.380394,-964,1],[[[[14,6,1],[14,6,-1]]],34,54,0.385005,-1157,-1],[[[[23,3,1]],[[23,3,-1]]],20,14,0.353763,1099,-1],[[[[4,15,1],[4,15,-1]]],2,46,0.379123,-117,-1],[[[[2,7,1],[2,7,-1]]],44,18,0.385352,20,-1],[[[[7,4,1]],[[7,4,-1]]],10,40,0.391829,47,-1],[[[[7,7,1]],[[7,7,-1]]],28,18,0.39474,621,-1],[[[[7,7,1]],[[7,7,-1]]],46,32,0.385502,125,-1],[[[[19,3,1]],[[19,3,-1]]],22,16,0.397226,672,-1],[[[[4,15,1],[4,15,-1]]],32,42,0.382633,-189,-1],[[[[12,4,1]],[[12,4,-1]]],28,44,0.388198,-1796,1],[[[[3,12,1],[3,12,-1]]],48,50,0.391439,49,1],[[[[29,3,1]],[[29,3,-1]]],16,46,0.382603,596,-1],[[[[3,23,1],[3,23,-1]]],34,16,0.381322,-78,-1],[[[[6,3,1]],[[6,3,-1]]],16,28,0.394335,50,-1],[[[[12,11,1]],[[12,11,-1]],[[12,11,1]]],28,20,0.395589,5997,1],[[[[3,6,1],[3,6,-1]]],48,56,0.387366,-42,-1]]," +
         "[0.656132,0.361293,0.460939,0.505842,0.600676,0.590538,0.544608,0.566505,0.572862,0.588349,0.614437,0.613929,0.626031,0.547421,0.610626,0.626948,0.644276,0.652183,0.627346,0.658996,0.619783,0.634516,0.64322,0.619704,0.61635,0.651078,0.654503,0.632296]," +
         "6.21674]," +
         "[[[[[[19,3,1]],[[19,3,-1]]],24,44,0.385573,1028,-1],[[[[6,23,1],[6,23,-1]]],46,38,0.287301,-1245,1],[[[[6,7,1]],[[6,7,-1]]],12,44,0.329856,-1350,1],[[[[4,4,1],[4,4,-1]]],8,40,0.350333,333,-1],[[[[7,9,1],[7,9,-1]]],36,20,0.373931,-280,1],[[[[9,7,1]],[[9,7,-1]]],32,30,0.39115,259,-1],[[[[3,9,1],[3,9,-1]]],48,34,0.375485,163,-1],[[[[4,6,1],[4,6,-1]]],26,36,0.375183,62,1],[[[[3,9,1],[3,9,-1]]],14,16,0.388639,355,-1],[[[[3,4,1],[3,4,-1]]],20,36,0.377171,21,1],[[[[3,5,1],[3,5,-1]]],10,34,0.385321,-66,1],[[[[4,23,1],[4,23,-1]]],56,40,0.387186,376,1],[[[[29,3,1]],[[29,3,-1]]],18,14,0.38816,-1288,1],[[[[23,19,1],[23,19,-1]]],4,32,0.382962,-18,-1],[[[[6,3,1]],[[6,3,-1]]],40,16,0.396213,85,-1],[[[[4,37,1],[4,37,-1]]],22,20,0.397898,-63,1],[[[[46,9,1]],[[46,9,-1]]],0,2,0.396988,-2004,1],[[[[7,3,1]],[[7,3,-1]]],34,42,0.399251,329,-1],[[[[6,15,1],[6,15,-1]]],40,48,0.383212,-510,-1],[[[[19,3,1]],[[19,3,-1]]],20,12,0.393849,728,-1],[[[[3,9,1],[3,9,-1]]],26,42,0.387691,-49,-1],[[[[23,2,1]],[[23,2,-1]]],22,48,0.396797,232,-1],[[[[3,12,1],[3,12,-1]]],26,42,0.378623,101,1],[[[[29,2,1]],[[29,2,-1]]],14,44,0.396891,-522,1],[[[[11,12,1],[11,12,-1]]],4,44,0.394313,322,-1],[[[[9,15,1],[9,15,-1]]],4,20,0.398302,-1886,1],[[[[2,5,1],[2,5,-1]]],30,38,0.400156,14,1],[[[[3,6,1],[3,6,-1]]],10,30,0.399512,130,-1],[[[[9,3,1]],[[9,3,-1]]],26,22,0.409353,83,-1],[[[[9,11,1]],[[9,11,-1]]],46,38,0.408393,-326,1],[[[[7,9,1]],[[7,9,-1]],[[7,9,1]]],14,36,0.390971,10646,-1],[[[[3,19,1],[3,19,-1]]],0,44,0.404919,-66,-1],[[[[4,23,1]],[[4,23,-1]]],60,6,0.402396,-1179,1],[[[[23,6,1]],[[23,6,-1]]],14,32,0.410733,1201,-1],[[[[5,4,1]],[[5,4,-1]]],26,14,0.40881,145,-1],[[[[2,6,1],[2,6,-1]]],38,40,0.409553,-7,-1],[[[[29,3,1]],[[29,3,-1]]],18,26,0.397415,613,-1],[[[[4,5,1],[4,5,-1]]],30,42,0.406741,-51,-1],[[[[2,12,1],[2,12,-1]]],48,28,0.400105,77,-1]]," +
         "[0.627532,0.403117,0.492216,0.539251,0.597267,0.642439,0.601243,0.600469,0.635694,0.605578,0.626865,0.631816,0.634415,0.620646,0.656212,0.660847,0.658341,0.66459,0.621303,0.649753,0.633161,0.657817,0.60933,0.658076,0.651017,0.661964,0.667101,0.665311,0.693058,0.690312,0.641957,0.680443,0.67335,0.697023,0.691505,0.693632,0.659517,0.685603,0.666959]," +
         "7.66028]," +
         "[[[[[[7,4,1],[7,4,-1]]],44,42,0.356299,-188,1],[[[[5,7,1]],[[5,7,-1]]],12,46,0.307277,-1405,1],[[[[6,7,1],[6,7,-1]]],6,40,0.331583,1636,-1],[[[[37,7,1]],[[37,7,-1]]],8,14,0.362177,2526,-1],[[[[46,7,1]],[[46,7,-1]]],6,36,0.380401,5426,-1],[[[[9,7,1]],[[9,7,-1]]],14,40,0.384796,-2198,1],[[[[3,4,1],[3,4,-1]]],28,38,0.370021,-34,-1],[[[[9,6,1],[9,6,-1]]],10,20,0.386998,637,-1],[[[[3,6,1],[3,6,-1]]],16,18,0.390042,-80,1],[[[[7,29,1],[7,29,-1]]],22,18,0.381714,-19,1],[[[[3,23,1],[3,23,-1]]],44,40,0.406704,-10,-1],[[[[14,15,1],[14,15,-1]]],34,40,0.402144,-2455,1],[[[[6,19,1],[6,19,-1]]],6,24,0.373752,-1968,1],[[[[4,6,1],[4,6,-1]]],32,48,0.387192,61,1],[[[[12,18,1]],[[12,18,-1]]],0,0,0.394354,-3128,1],[[[[3,4,1],[3,4,-1]]],16,20,0.411018,76,-1],[[[[5,23,1]],[[5,23,-1]]],26,10,0.397567,-215,-1],[[[[29,2,1]],[[29,2,-1]]],14,46,0.393813,-560,1],[[[[2,19,1],[2,19,-1]]],34,34,0.396587,-29,-1],[[[[6,3,1]],[[6,3,-1]]],34,44,0.386908,178,-1],[[[[4,9,1],[4,9,-1]]],24,44,0.392785,-99,-1],[[[[23,2,1]],[[23,2,-1]]],20,44,0.398973,-434,1],[[[[11,12,1],[11,12,-1]]],20,14,0.388527,-2479,-1],[[[[37,11,1]],[[37,11,-1]],[[37,11,1]]],8,18,0.392796,19669,1],[[[[19,9,1]],[[19,9,-1]]],36,4,0.408405,-255,1],[[[[6,3,1]],[[6,3,-1]]],14,20,0.405285,14,-1],[[[[6,7,1],[6,7,-1]]],44,24,0.410836,659,-1],[[[[4,6,1],[4,6,-1]]],48,58,0.395981,-73,-1],[[[[2,9,1],[2,9,-1]]],48,24,0.389757,-69,1],[[[[3,7,1],[3,7,-1]]],4,44,0.407682,92,1],[[[[29,2,1]],[[29,2,-1]]],16,16,0.401018,-443,1],[[[[9,19,1],[9,19,-1]]],0,42,0.382408,549,-1],[[[[6,3,1]],[[6,3,-1]]],28,18,0.413747,-28,1],[[[[6,6,1],[6,6,-1]]],36,40,0.418134,-18,-1],[[[[2,6,1],[2,6,-1]]],44,20,0.410653,-67,1],[[[[2,7,1],[2,7,-1]]],30,34,0.39591,18,1],[[[[15,2,1]],[[15,2,-1]]],24,30,0.405975,-210,1]]," +
         "[0.553517,0.443577,0.496073,0.567833,0.613948,0.625476,0.587355,0.631315,0.639457,0.617374,0.6855,0.672643,0.59681,0.631831,0.651129,0.697845,0.659935,0.649657,0.657239,0.631075,0.646863,0.663818,0.635396,0.646894,0.690345,0.681479,0.697321,0.655578,0.63869,0.688282,0.669498,0.619191,0.705747,0.718608,0.696794,0.655383,0.683432]," +
         "7.07858]," +
         "[[[[[[4,5,1],[4,5,-1]]],8,58,0.217845,215,1],[[[[4,15,1],[4,15,-1]]],48,38,0.327625,-1417,1],[[[[4,23,1],[4,23,-1]]],8,40,0.367166,861,-1],[[[[12,2,1]],[[12,2,-1]]],26,26,0.381068,-68,1],[[[[4,7,1]],[[4,7,-1]]],32,44,0.38785,-185,1],[[[[23,3,1]],[[23,3,-1]]],20,12,0.368103,1730,-1],[[[[2,15,1],[2,15,-1]]],32,38,0.375122,25,1],[[[[5,3,1]],[[5,3,-1]]],36,16,0.392297,141,-1],[[[[4,15,1],[4,15,-1]]],24,20,0.398279,-58,1],[[[[11,15,1],[11,15,-1]]],22,30,0.40404,-111,-1],[[[[3,5,1],[3,5,-1]]],42,18,0.396719,-253,1],[[[[2,23,1],[2,23,-1]]],56,38,0.383635,63,1],[[[[37,3,1]],[[37,3,-1]]],8,46,0.3956,624,-1],[[[[2,4,1],[2,4,-1]]],26,26,0.398164,-26,-1],[[[[3,5,1],[3,5,-1]]],44,18,0.401514,95,-1],[[[[6,9,1],[6,9,-1]]],10,32,0.405233,589,-1],[[[[3,12,1],[3,12,-1]]],20,50,0.402887,-62,-1],[[[[23,7,1]],[[23,7,-1]]],18,38,0.398546,9401,-1],[[[[6,12,1],[6,12,-1]]],46,38,0.39316,-436,1],[[[[15,2,1]],[[15,2,-1]]],38,38,0.405333,57,-1],[[[[29,7,1]],[[29,7,-1]]],12,40,0.413133,-6277,1],[[[[4,6,1]],[[4,6,-1]]],14,38,0.406196,42,-1],[[[[4,4,1],[4,4,-1]]],32,38,0.411804,36,1],[[[[11,19,1],[11,19,-1],[11,19,1]]],14,30,0.401285,6541,1],[[[[3,7,1],[3,7,-1]]],6,50,0.402278,-25,-1],[[[[3,7,1],[3,7,-1]]],44,42,0.406627,76,-1],[[[[3,6,1],[3,6,-1]]],50,54,0.410665,-39,-1],[[[[29,2,1]],[[29,2,-1]]],22,26,0.402381,145,-1],[[[[19,4,1]],[[19,4,-1]]],18,10,0.413391,-304,1],[[[[14,5,1],[14,5,-1]]],34,6,0.407865,-796,-1],[[[[4,5,1],[4,5,-1]]],44,20,0.403669,-196,1],[[[[5,23,1]],[[5,23,-1]]],28,10,0.408374,5225,1],[[[[23,2,1]],[[23,2,-1]]],20,16,0.397465,-417,1],[[[[3,4,1],[3,4,-1]]],30,44,0.399894,-39,-1],[[[[5,3,1]],[[5,3,-1]]],34,44,0.399474,135,-1],[[[[12,6,1]],[[12,6,-1]]],10,26,0.406576,-349,-1],[[[[4,9,1],[4,9,-1]]],16,8,0.405906,-24,1],[[[[5,3,1]],[[5,3,-1]]],46,30,0.414306,47,-1],[[[[4,9,1]],[[4,9,-1]]],6,16,0.41957,58,-1],[[[[4,6,1],[4,6,-1]]],30,42,0.419059,60,1],[[[[14,12,1],[14,12,-1]]],36,30,0.397343,7646,-1],[[[[2,7,1],[2,7,-1]]],42,50,0.397006,12,1],[[[[11,19,1],[11,19,-1]]],30,30,0.418853,269,-1],[[[[3,12,1],[3,12,-1]]],12,20,0.4177,217,-1],[[[[2,19,1],[2,19,-1]]],36,42,0.416559,16,1],[[[[3,19,1],[3,19,-1]]],12,26,0.413303,-69,1],[[[[2,4,1],[2,4,-1]]],20,36,0.413927,8,1],[[[[7,4,1],[7,4,-1]]],40,22,0.407934,415,-1]]," +
         "[0.278519,0.487265,0.580193,0.615686,0.633587,0.582537,0.600313,0.645542,0.661899,0.677965,0.657603,0.622414,0.654533,0.661581,0.670883,0.68133,0.674724,0.662638,0.647881,0.681613,0.703963,0.684058,0.700114,0.670244,0.673018,0.68528,0.696829,0.673306,0.704713,0.688805,0.67692,0.690258,0.659654,0.666372,0.665207,0.685136,0.683237,0.707375,0.72286,0.721347,0.65932,0.658391,0.720736,0.717329,0.713968,0.704457,0.706271,0.689]," +
         "9.4851]," +
         "[[[[[[2,4,1],[2,4,-1],[2,4,1]]],36,60,0.17343,155,-1],[[[[11,23,1],[11,23,-1]]],0,40,0.291208,3023,-1],[[[[14,23,1],[14,23,-1]]],36,40,0.34555,-6447,1],[[[[12,6,1]],[[12,6,-1]]],28,30,0.362992,375,-1],[[[[15,6,1]],[[15,6,-1]]],32,16,0.36482,525,-1],[[[[29,7,1]],[[29,7,-1]]],0,38,0.371674,5147,-1],[[[[3,15,1],[3,15,-1]]],4,42,0.372003,214,1],[[[[29,9,1]],[[29,9,-1]],[[29,9,1]]],18,22,0.374932,10087,1],[[[[3,4,1],[3,4,-1]]],24,20,0.382917,-18,1],[[[[9,6,1],[9,6,-1]]],26,14,0.382148,-571,-1],[[[[6,6,1],[6,6,-1]]],48,32,0.378733,313,-1],[[[[2,29,1],[2,29,-1]]],4,34,0.393797,-57,-1],[[[[2,6,1],[2,6,-1]]],50,36,0.377881,-40,1],[[[[11,12,1],[11,12,-1]]],4,6,0.3977,-127,1],[[[[4,4,1]],[[4,4,-1]]],48,38,0.408281,30,-1],[[[[15,2,1]],[[15,2,-1]]],22,24,0.394544,57,-1],[[[[4,12,1],[4,12,-1]]],46,52,0.391849,-162,-1],[[[[23,3,1]],[[23,3,-1]]],20,46,0.386875,866,-1],[[[[2,7,1],[2,7,-1]]],32,44,0.386759,-20,-1],[[[[15,3,1]],[[15,3,-1]]],0,28,0.392016,145,-1],[[[[4,3,1]],[[4,3,-1]],[[4,3,1]]],54,0,0.409321,810,1],[[[[3,4,1],[3,4,-1]]],16,20,0.403471,-40,1],[[[[14,29,1],[14,29,-1]]],20,14,0.39074,3238,1],[[[[14,12,1],[14,12,-1]]],20,28,0.3929,-229,-1],[[[[15,2,1]],[[15,2,-1]]],24,32,0.390725,182,-1],[[[[11,9,1],[11,9,-1]]],18,38,0.393193,353,1],[[[[4,19,1],[4,19,-1]]],14,34,0.404283,-63,1],[[[[9,7,1]],[[9,7,-1]]],34,30,0.400798,147,-1],[[[[2,4,1],[2,4,-1]]],14,22,0.39771,-11,1],[[[[2,12,1],[2,12,-1]]],22,48,0.393728,28,1],[[[[23,2,1]],[[23,2,-1]]],20,36,0.388953,-246,1],[[[[11,7,1],[11,7,-1]]],22,16,0.391856,-1262,-1],[[[[37,2,1]],[[37,2,-1]]],14,50,0.396724,-2,-1],[[[[3,12,1],[3,12,-1]]],4,44,0.407996,-72,-1],[[[[7,3,1]],[[7,3,-1]]],34,14,0.395908,401,-1],[[[[5,23,1]],[[5,23,-1]]],24,12,0.397605,5616,1],[[[[15,4,1]],[[15,4,-1]],[[15,4,1]]],24,14,0.389097,2168,1],[[[[6,23,1]],[[6,23,-1]]],32,10,0.391848,4,-1],[[[[23,3,1]],[[23,3,-1]]],24,12,0.405899,-818,1],[[[[23,4,1],[23,4,-1]]],12,52,0.395222,-1043,-1],[[[[15,4,1]],[[15,4,-1]]],24,28,0.410718,-563,1],[[[[3,7,1],[3,7,-1]]],38,50,0.400947,16,1],[[[[3,7,1],[3,7,-1]]],8,34,0.414447,267,-1],[[[[23,6,1],[23,6,-1]]],16,8,0.404265,-1549,-1]]," +
         "[0.209819,0.410851,0.528001,0.569839,0.574357,0.59153,0.592365,0.599826,0.620527,0.61851,0.609613,0.649613,0.60741,0.660301,0.68999,0.651648,0.644329,0.630989,0.630681,0.644781,0.692967,0.676364,0.641336,0.647175,0.641296,0.64797,0.678648,0.668887,0.660329,0.649426,0.636534,0.644347,0.657617,0.689179,0.655378,0.66004,0.63692,0.644326,0.683216,0.6535,0.69698,0.6693,0.707787,0.678598]," +
         "10.3652]," +
         "[[[[[[6,19,1],[6,19,-1]]],22,12,0.181354,-3145,-1],[[[[3,4,1],[3,4,-1]]],32,30,0.162067,-95,-1],[[[[3,19,1],[3,19,-1]]],24,20,0.314018,-95,1],[[[[11,7,1],[11,7,-1]]],42,42,0.349289,-3892,1],[[[[9,3,1]],[[9,3,-1]]],2,44,0.355487,18,-1],[[[[18,29,1],[18,29,-1]]],0,32,0.358701,5652,-1],[[[[9,15,1],[9,15,-1]]],12,36,0.359747,17,1],[[[[19,9,1]],[[19,9,-1]]],12,40,0.368056,-6741,1],[[[[4,4,1],[4,4,-1]]],30,26,0.381825,20,1],[[[[6,11,1]],[[6,11,-1]]],10,30,0.375237,827,-1],[[[[3,12,1],[3,12,-1]]],22,46,0.379113,-17,-1],[[[[9,9,1]],[[9,9,-1]]],40,20,0.373662,667,-1],[[[[4,5,1],[4,5,-1]]],28,18,0.379183,160,1],[[[[2,4,1],[2,4,-1]]],48,24,0.371745,-36,1],[[[[2,9,1],[2,9,-1]]],26,48,0.368169,15,1],[[[[4,4,1],[4,4,-1]]],46,26,0.363737,188,-1],[[[[6,14,1]],[[6,14,-1]]],54,36,0.368534,-3400,-1],[[[[4,4,1],[4,4,-1],[4,4,1]]],6,0,0.363739,1208,1],[[[[3,5,1],[3,5,-1]]],12,22,0.378106,93,-1],[[[[9,2,1]],[[9,2,-1]]],48,0,0.381589,-21,-1],[[[[4,4,1],[4,4,-1],[4,4,1]]],18,42,0.380429,216,1],[[[[4,9,1]],[[4,9,-1]],[[4,9,1]]],32,14,0.362481,2690,-1],[[[[2,4,1],[2,4,-1]]],26,34,0.372945,-6,-1],[[[[5,4,1]],[[5,4,-1]]],16,26,0.380342,100,-1],[[[[2,12,1],[2,12,-1]]],28,36,0.378315,-26,-1],[[[[3,4,1],[3,4,-1]]],46,24,0.373238,-69,1],[[[[3,6,1],[3,6,-1]]],48,34,0.383385,48,-1]]," +
         "[0.22153,0.193413,0.457764,0.536781,0.55156,0.559335,0.561882,0.582418,0.617666,0.600608,0.6106,0.596581,0.61078,0.59171,0.582701,0.571676,0.583617,0.571682,0.607991,0.617048,0.61402,0.56858,0.594756,0.613793,0.608533,0.595503,0.621758]," +
         "8.52046]," +
         "[[[[[[3,29,1],[3,29,-1]]],34,22,0.152736,-286,-1],[[[[3,5,1],[3,5,-1]]],40,50,0.065003,177,1],[[[[6,5,1],[6,5,-1]]],6,44,0.302304,437,-1],[[[[7,3,1]],[[7,3,-1]]],26,2,0.314646,13,-1],[[[[18,7,1],[18,7,-1]]],28,40,0.312065,-1683,1],[[[[4,12,1],[4,12,-1]]],42,38,0.317077,134,-1],[[[[12,11,1]],[[12,11,-1]],[[12,11,1]]],52,0,0.3138,18787,1],[[[[2,23,1],[2,23,-1]]],2,40,0.32075,0,-1],[[[[9,12,1],[9,12,-1]]],20,14,0.319703,-209,1],[[[[3,6,1],[3,6,-1]]],54,42,0.328576,24,1],[[[[4,3,1]],[[4,3,-1]]],24,14,0.323274,-131,1],[[[[2,12,1],[2,12,-1]]],60,52,0.324537,-20,-1],[[[[19,2,1]],[[19,2,-1]]],4,40,0.338094,2,-1],[[[[4,3,1]],[[4,3,-1]]],28,10,0.331404,-6,1],[[[[11,4,1],[11,4,-1]]],10,22,0.338755,-427,-1],[[[[6,4,1]],[[6,4,-1]]],16,44,0.34107,-322,1],[[[[9,7,1],[9,7,-1]]],32,40,0.341421,-39,-1],[[[[18,9,1],[18,9,-1]]],18,22,0.347421,508,1]]," +
         "[0.180269,0.0695221,0.43329,0.459099,0.453625,0.464294,0.457302,0.472211,0.469946,0.489371,0.477704,0.480467,0.510789,0.495673,0.512298,0.517612,0.51842,0.532382]," +
         "8.76429]," +
         "[[[[[[14,23,1],[14,23,-1]]],34,4,0.14189,16405,1],[[[[2,12,1],[2,12,-1]]],28,44,0.0330043,-114,-1],[[[[4,7,1],[4,7,-1]]],34,30,0.231538,5,-1],[[[[2,4,1],[2,4,-1]]],58,42,0.222521,14,1],[[[[12,6,1]],[[12,6,-1]]],52,34,0.237395,67,1],[[[[5,2,1]],[[5,2,-1]]],10,40,0.253924,7,-1],[[[[2,6,1],[2,6,-1]]],18,34,0.244681,-37,-1],[[[[12,9,1]],[[12,9,-1]],[[12,9,1]]],32,14,0.264094,7308,-1]]," +
         "[0.165352,0.0341307,0.301301,0.286209,0.311295,0.340346,0.323943,0.35887]," +
         "7.55546]," +
         "[[[[[[3,7,1],[3,7,-1]]],32,32,0.0621373,-172,-1],[[[[4,23,1],[4,23,-1],[4,23,1]]],20,8,0.0152055,14783,1],[[[[2,6,1],[2,6,-1]]],6,40,0.0601751,56,1],[[[[4,4,1],[4,4,-1]]],22,52,0.127586,-29,-1]]," +
         "[0.0662542,0.0154403,0.064028,0.146245]," +
         "8.80751]" +
         "]";

   detectInImageSetAndStore(strongClassifierStr);
	return 0;
}
